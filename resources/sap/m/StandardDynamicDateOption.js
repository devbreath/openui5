/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/core/library','./DynamicDateOption','./Label','./RadioButton','./RadioButtonGroup','sap/ui/core/date/UniversalDateUtils','sap/ui/core/date/UniversalDate','sap/m/DynamicDateValueHelpUIType','./library'],function(c,D,L,R,a,U,b,d,l){"use strict";var V=c.VerticalAlign;var S=D.extend("sap.m.StandardDynamicDateOption",{metadata:{library:"sap.m"}});var M=1;var e=6000;var K={"DATE":"DATE","DATETIME":"DATETIME","DATERANGE":"DATERANGE","DATETIMERANGE":"DATETIMERANGE","TODAY":"TODAY","YESTERDAY":"YESTERDAY","TOMORROW":"TOMORROW","SPECIFICMONTH":"SPECIFICMONTH","SPECIFICMONTHINYEAR":"SPECIFICMONTHINYEAR","FIRSTDAYWEEK":"FIRSTDAYWEEK","LASTDAYWEEK":"LASTDAYWEEK","FIRSTDAYMONTH":"FIRSTDAYMONTH","LASTDAYMONTH":"LASTDAYMONTH","FIRSTDAYQUARTER":"FIRSTDAYQUARTER","LASTDAYQUARTER":"LASTDAYQUARTER","FIRSTDAYYEAR":"FIRSTDAYYEAR","LASTDAYYEAR":"LASTDAYYEAR","THISWEEK":"THISWEEK","THISMONTH":"THISMONTH","THISQUARTER":"THISQUARTER","THISYEAR":"THISYEAR","LASTWEEK":"LASTWEEK","LASTMONTH":"LASTMONTH","LASTQUARTER":"LASTQUARTER","LASTYEAR":"LASTYEAR","NEXTWEEK":"NEXTWEEK","NEXTMONTH":"NEXTMONTH","NEXTQUARTER":"NEXTQUARTER","NEXTYEAR":"NEXTYEAR","LASTDAYS":"LASTDAYS","LASTWEEKS":"LASTWEEKS","LASTMONTHS":"LASTMONTHS","LASTQUARTERS":"LASTQUARTERS","LASTYEARS":"LASTYEARS","NEXTDAYS":"NEXTDAYS","NEXTWEEKS":"NEXTWEEKS","NEXTMONTHS":"NEXTMONTHS","NEXTQUARTERS":"NEXTQUARTERS","NEXTYEARS":"NEXTYEARS","FROM":"FROM","TO":"TO","FROMDATETIME":"FROMDATETIME","TODATETIME":"TODATETIME","YEARTODATE":"YEARTODATE","DATETOYEAR":"DATETOYEAR","TODAYFROMTO":"TODAYFROMTO","QUARTER1":"QUARTER1","QUARTER2":"QUARTER2","QUARTER3":"QUARTER3","QUARTER4":"QUARTER4"};var _={"SingleDates":1,"DateRanges":2,"Weeks":3,"Months":4,"Quarters":5,"Years":6};var f={"DATE":_.SingleDates,"DATETIME":_.SingleDates,"DATERANGE":_.DateRanges,"DATETIMERANGE":_.DateRanges,"TODAY":_.SingleDates,"YESTERDAY":_.SingleDates,"TOMORROW":_.SingleDates,"SPECIFICMONTH":_.Months,"SPECIFICMONTHINYEAR":_.Months,"FIRSTDAYWEEK":_.SingleDates,"LASTDAYWEEK":_.SingleDates,"FIRSTDAYMONTH":_.SingleDates,"LASTDAYMONTH":_.SingleDates,"FIRSTDAYQUARTER":_.SingleDates,"LASTDAYQUARTER":_.SingleDates,"FIRSTDAYYEAR":_.SingleDates,"LASTDAYYEAR":_.SingleDates,"THISWEEK":_.Weeks,"THISMONTH":_.Months,"THISQUARTER":_.Quarters,"THISYEAR":_.Years,"LASTWEEK":_.Weeks,"LASTMONTH":_.Months,"LASTQUARTER":_.Quarters,"LASTYEAR":_.Years,"NEXTWEEK":_.Weeks,"NEXTMONTH":_.Months,"NEXTQUARTER":_.Quarters,"NEXTYEAR":_.Years,"LASTDAYS":_.DateRanges,"LASTWEEKS":_.DateRanges,"LASTMONTHS":_.DateRanges,"LASTQUARTERS":_.DateRanges,"LASTYEARS":_.DateRanges,"NEXTDAYS":_.DateRanges,"NEXTWEEKS":_.DateRanges,"NEXTMONTHS":_.DateRanges,"NEXTQUARTERS":_.DateRanges,"NEXTYEARS":_.DateRanges,"FROM":_.DateRanges,"TO":_.DateRanges,"FROMDATETIME":_.DateRanges,"TODATETIME":_.DateRanges,"YEARTODATE":_.DateRanges,"DATETOYEAR":_.DateRanges,"TODAYFROMTO":_.DateRanges,"QUARTER1":_.Quarters,"QUARTER2":_.Quarters,"QUARTER3":_.Quarters,"QUARTER4":_.Quarters};var g=["LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS"];var n=["NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"];S.LastXKeys=g;S.NextXKeys=n;var h=sap.ui.getCore().getLibraryResourceBundle("sap.m");S.Keys=K;S.prototype.exit=function(){if(this.aValueHelpUITypes){while(this.aValueHelpUITypes.length){this.aValueHelpUITypes.pop().destroy();}delete this.aValueHelpUITypes;}};S.prototype.getText=function(C){var k=this.getKey();var o=C._getOptions();var p=this.getValueHelpUITypes(C);var i=this._getOptionParams(g,o);var N=this._getOptionParams(n,o);if(i){p.push(i);}if(N){p.push(N);}switch(k){case K.LASTDAYS:case K.LASTWEEKS:case K.LASTMONTHS:case K.LASTQUARTERS:case K.LASTYEARS:case K.NEXTDAYS:case K.NEXTWEEKS:case K.NEXTMONTHS:case K.NEXTQUARTERS:case K.NEXTYEARS:return this._getXPeriodTitle(p[1].getOptions());case K.FROMDATETIME:case K.TODATETIME:case K.DATETIMERANGE:return C._findOption(k)._bAdditionalTimeText?h.getText("DYNAMIC_DATE_"+k+"_TITLE")+" ("+h.getText("DYNAMIC_DATE_DATETIME_TITLE")+")":h.getText("DYNAMIC_DATE_"+k+"_TITLE");default:return h.getText("DYNAMIC_DATE_"+k+"_TITLE");}};S.prototype.getValueHelpUITypes=function(C){var k=this.getKey();if(!this.aValueHelpUITypes){switch(k){case K.TODAY:case K.YESTERDAY:case K.TOMORROW:case K.FIRSTDAYWEEK:case K.LASTDAYWEEK:case K.FIRSTDAYMONTH:case K.LASTDAYMONTH:case K.FIRSTDAYQUARTER:case K.LASTDAYQUARTER:case K.FIRSTDAYYEAR:case K.LASTDAYYEAR:case K.THISWEEK:case K.THISMONTH:case K.THISQUARTER:case K.THISYEAR:case K.LASTWEEK:case K.LASTMONTH:case K.LASTQUARTER:case K.LASTYEAR:case K.NEXTWEEK:case K.NEXTMONTH:case K.NEXTQUARTER:case K.NEXTYEAR:case K.YEARTODATE:case K.DATETOYEAR:case K.QUARTER1:case K.QUARTER2:case K.QUARTER3:case K.QUARTER4:this.aValueHelpUITypes=[];break;case K.DATETIME:case K.FROMDATETIME:case K.TODATETIME:this.aValueHelpUITypes=[new d({type:"datetime"})];break;case K.DATE:case K.FROM:case K.TO:this.aValueHelpUITypes=[new d({type:"date"})];break;case K.DATERANGE:this.aValueHelpUITypes=[new d({type:"daterange"})];break;case K.SPECIFICMONTH:this.aValueHelpUITypes=[new d({type:"month"})];break;case K.SPECIFICMONTHINYEAR:this.aValueHelpUITypes=[new d({type:"custommonth"})];break;case K.LASTDAYS:case K.LASTWEEKS:case K.LASTMONTHS:case K.LASTQUARTERS:case K.LASTYEARS:case K.NEXTDAYS:case K.NEXTWEEKS:case K.NEXTMONTHS:case K.NEXTQUARTERS:case K.NEXTYEARS:this.aValueHelpUITypes=[new d({text:h.getText("DDR_LASTNEXTX_LABEL"),type:"int"})];break;case K.TODAYFROMTO:this.aValueHelpUITypes=[new d({text:h.getText("DDR_TODAYFROMTO_FROM_LABEL"),type:"int",additionalText:h.getText("DDR_TODAYFROMTO_TO_ADDITIONAL_LABEL")}),new d({text:h.getText("DDR_TODAYFROMTO_TO_LABEL"),type:"int",additionalText:h.getText("DDR_TODAYFROMTO_TO_ADDITIONAL_LABEL")})];break;case K.DATETIMERANGE:this.aValueHelpUITypes=[new d({text:h.getText("DDR_DATETIMERANGE_FROM_LABEL"),type:"datetime"}),new d({text:h.getText("DDR_DATETIMERANGE_TO_LABEL"),type:"datetime"})];break;}}return this.aValueHelpUITypes.slice(0);};S.prototype.createValueHelpUI=function(C,i){var o=C._getOptions(),v=C.getValue()&&Object.assign({},C.getValue()),p=this.getValueHelpUITypes(C),j=[],k;if(!C.aControlsByParameters){C.aControlsByParameters={};}C.aControlsByParameters[this.getKey()]=[];var q=this._getOptionParams(g,o),N=this._getOptionParams(n,o);if(q){p.push(q);}if(N){p.push(N);}if(v&&v.values){v.values=v.values.map(function(s){if(s instanceof Date){return C._reverseConvertDate(s);}return s;});}for(var I=0;I<p.length;I++){k=null;if(p[I].getOptions()&&p[I].getOptions().length<=1){break;}else if(p[I].getText()){k=new L({text:p[I].getText(),width:"100%"});j.push(k);}var r;var u=false;if(C&&v){u=C._checkFormatterUTCTimezone(v.operator);}switch(p[I].getType()){case"int":r=this._createIntegerControl(v,I,i);if(v&&p[1]&&p[1].getOptions()&&p[1].getOptions().indexOf(v.operator.slice(4).toLowerCase())!==-1){r.setValue(v.values[I]);}break;case"date":r=this._createDateControl(v,I,i,u);break;case"datetime":if(p.length===1){r=this._createDateTimeInnerControl(v,I,i,u);}else if(p.length===2){r=this._createDateTimeControl(v,I,i,u);}break;case"daterange":r=this._createDateRangeControl(v,I,i,u);break;case"month":r=this._createMonthControl(v,I,i);break;case"custommonth":r=this._createCustomMonthControl(v,I,i);break;case"options":r=this._createOptionsControl(v,I,i,p);break;default:break;}j.push(r);k&&k.setLabelFor(r);if(p[I].getAdditionalText()){j.push(new L({vAlign:V.Bottom,text:p[I].getAdditionalText()}).addStyleClass("sapMDDRAdditionalLabel"));}C.aControlsByParameters[this.getKey()].push(r);}return j;};S.prototype._createIntegerControl=function(v,i,C){var o=D.prototype._createIntegerControl.call(this,v,i,C);var j=this.getKey()==="TODAYFROMTO"?-e:M;var u=!v||this.getKey()!==v.operator;if(u){o.setValue(1);}o.setMin(j);o.setMax(e);return o;};S.prototype._createOptionsControl=function(v,i,C,p){var o=new a({buttons:[p[i].getOptions().map(m)]});if(v){var O=p[i].getOptions().indexOf(v.operator.slice(4).toLowerCase());if(O!==-1){o.setSelectedIndex(O);}}if(C instanceof Function){o.attachSelect(function(){C(this);},this);}return o;};S.prototype._getOptionParams=function(G,o){if(G.indexOf(this.getKey())!==-1){return new d({text:h.getText("DDR_LASTNEXTX_TIME_PERIODS_LABEL"),type:"options",options:o?o.filter(function(i){return G.indexOf(i.getKey())!==-1;}).map(function(i){return i.getKey().slice(4).toLowerCase();}):[]});}return undefined;};S.prototype.validateValueHelpUI=function(C){var p=this.getValueHelpUITypes();for(var i=0;i<p.length;i++){var I=C.aControlsByParameters[this.getKey()][i];switch(p[i].getType()){case"int":if(I._isLessThanMin(I.getValue())||I._isMoreThanMax(I.getValue())){return false;}break;case"month":case"custommonth":case"date":case"daterange":if(!I.getSelectedDates()||I.getSelectedDates().length==0){return false;}break;case"datetime":if(p.length===1){if(!I.getCalendar().getSelectedDates()||I.getCalendar().getSelectedDates().length==0){return false;}}else if(!I.getDateValue()&&p.length===2){return false;}break;case"options":if(I.getSelectedIndex()<0){return false;}break;default:break;}}return true;};S.prototype.getValueHelpOutput=function(C){var o=C._getOptions();var p=this.getValueHelpUITypes(C),r={},O;if(g.indexOf(this.getKey())!==-1&&C.aControlsByParameters[this.getKey()].length>1){r.operator=o.filter(function(s){return g.indexOf(s.getKey())!==-1;})[C.aControlsByParameters[this.getKey()][1].getSelectedIndex()].getKey();}else if(n.indexOf(this.getKey())!==-1&&C.aControlsByParameters[this.getKey()].length>1){r.operator=o.filter(function(s){return n.indexOf(s.getKey())!==-1;})[C.aControlsByParameters[this.getKey()][1].getSelectedIndex()].getKey();}else{r.operator=this.getKey();}r.values=[];for(var i=0;i<p.length;i++){var I=C.aControlsByParameters[this.getKey()][i];switch(p[i].getType()){case"int":O=I.getValue();break;case"month":if(!I.getSelectedDates()||!I.getSelectedDates().length){return null;}O=I.getSelectedDates()[0].getStartDate().getMonth();break;case"custommonth":if(!I.getSelectedDates()||!I.getSelectedDates().length){return null;}O=[I.getSelectedDates()[0].getStartDate().getMonth(),I.getSelectedDates()[0].getStartDate().getFullYear()];break;case"date":if(!I.getSelectedDates().length){return null;}O=I.getSelectedDates()[0].getStartDate();break;case"datetime":if(p.length===1){var j,t,k,q;k=I.getCalendar();q=I.getClocks();if(!k.getSelectedDates().length){return null;}j=k.getSelectedDates()[0].getStartDate();t=q.getTimeValues();j.setHours(t.getHours(),t.getMinutes(),t.getSeconds());O=j;}else if(p.length===2){if(!I.getDateValue()){return null;}O=I.getDateValue();}break;case"daterange":if(!I.getSelectedDates().length){return null;}var E=I.getSelectedDates()[0].getEndDate()||I.getSelectedDates()[0].getStartDate();O=[I.getSelectedDates()[0].getStartDate(),E];break;default:break;}if(Array.isArray(O)){r.values=Array.prototype.concat.apply(r.values,O);}else{O!==null&&O!==undefined&&r.values.push(O);}}return r;};S.prototype.getGroup=function(){return f[this.getKey()];};S.prototype.getGroupHeader=function(){return h.getText("DDR_OPTIONS_GROUP_"+f[this.getKey()]);};S.prototype.format=function(o,F){return F.format(o,true);};S.prototype.parse=function(v,F){return F.parse(v,this.getKey());};S.prototype.toDates=function(v){if(!v){return null;}var k=v.operator;var p=v.values[0]||0;switch(k){case"SPECIFICMONTH":var o=new b();o.setMonth(v.values[0]);o=U.getMonthStartDate(o);return U.getRange(0,"MONTH",o);case"SPECIFICMONTHINYEAR":var o=new b();o.setMonth(v.values[0]);o.setYear(v.values[1]);o=U.getMonthStartDate(o);return U.getRange(0,"MONTH",o);case"DATE":return U.getRange(0,"DAY",b.getInstance(v.values[0]));case"DATETIME":var i=new b.getInstance(v.values[0]);return[i,i];case"DATERANGE":var s=b.getInstance(v.values[0]);var E=b.getInstance(v.values[1]);return[U.resetStartTime(s),U.resetEndTime(E)];case"DATETIMERANGE":var s=b.getInstance(v.values[0]);var E=b.getInstance(v.values[1]);s.setMilliseconds(0);E.setMilliseconds(999);return[s,E];case"TODAY":return U.ranges.today();case"YESTERDAY":return U.ranges.yesterday();case"TOMORROW":return U.ranges.tomorrow();case"FIRSTDAYWEEK":return U.ranges.firstDayOfWeek();case"LASTDAYWEEK":return U.ranges.lastDayOfWeek();case"FIRSTDAYMONTH":return U.ranges.firstDayOfMonth();case"LASTDAYMONTH":return U.ranges.lastDayOfMonth();case"FIRSTDAYQUARTER":return U.ranges.firstDayOfQuarter();case"LASTDAYQUARTER":return U.ranges.lastDayOfQuarter();case"FIRSTDAYYEAR":return U.ranges.firstDayOfYear();case"LASTDAYYEAR":return U.ranges.lastDayOfYear();case"THISWEEK":return U.ranges.currentWeek();case"THISMONTH":return U.ranges.currentMonth();case"THISQUARTER":return U.ranges.currentQuarter();case"THISYEAR":return U.ranges.currentYear();case"LASTWEEK":return U.ranges.lastWeek();case"LASTMONTH":return U.ranges.lastMonth();case"LASTQUARTER":return U.ranges.lastQuarter();case"LASTYEAR":return U.ranges.lastYear();case"NEXTWEEK":return U.ranges.nextWeek();case"NEXTMONTH":return U.ranges.nextMonth();case"NEXTQUARTER":return U.ranges.nextQuarter();case"NEXTYEAR":return U.ranges.nextYear();case"LASTDAYS":return U.ranges.lastDays(p);case"LASTWEEKS":return U.ranges.lastWeeks(p);case"LASTMONTHS":return U.ranges.lastMonths(p);case"LASTQUARTERS":return U.ranges.lastQuarters(p);case"LASTYEARS":return U.ranges.lastYears(p);case"NEXTDAYS":return U.ranges.nextDays(p);case"NEXTWEEKS":return U.ranges.nextWeeks(p);case"NEXTMONTHS":return U.ranges.nextMonths(p);case"NEXTQUARTERS":return U.ranges.nextQuarters(p);case"NEXTYEARS":return U.ranges.nextYears(p);case"FROM":return[b.getInstance(v.values[0])];case"TO":return[b.getInstance(v.values[0])];case"FROMDATETIME":var o=b.getInstance(v.values[0]);o.setMilliseconds(0);return[o];case"TODATETIME":var o=b.getInstance(v.values[0]);o.setMilliseconds(999);return[o];case"YEARTODATE":return U.ranges.yearToDate();case"DATETOYEAR":return U.ranges.dateToYear();case"TODAYFROMTO":if(v.values.length!==2){return[];}var x=v.values[0];var y=v.values[1];var s=x>=0?U.ranges.lastDays(x)[0]:U.ranges.nextDays(-x)[1];var E=y>=0?U.ranges.nextDays(y)[1]:U.ranges.lastDays(-y)[0];if(s.oDate.getTime()>E.oDate.getTime()){E=[s,s=E][0];}return[U.resetStartTime(s),U.resetEndTime(E)];case"QUARTER1":return U.ranges.quarter(1);case"QUARTER2":return U.ranges.quarter(2);case"QUARTER3":return U.ranges.quarter(3);case"QUARTER4":return U.ranges.quarter(4);default:return[];}};S.prototype.enhanceFormattedValue=function(){switch(this.getKey()){case"TODAY":case"YESTERDAY":case"TOMORROW":case"FIRSTDAYWEEK":case"LASTDAYWEEK":case"FIRSTDAYMONTH":case"LASTDAYMONTH":case"FIRSTDAYQUARTER":case"LASTDAYQUARTER":case"FIRSTDAYYEAR":case"LASTDAYYEAR":case"THISWEEK":case"THISMONTH":case"THISQUARTER":case"THISYEAR":case"LASTWEEK":case"LASTMONTH":case"LASTQUARTER":case"LASTYEAR":case"NEXTWEEK":case"NEXTMONTH":case"NEXTQUARTER":case"NEXTYEAR":case"YEARTODATE":case"DATETOYEAR":case"QUARTER1":case"QUARTER2":case"QUARTER3":case"QUARTER4":return true;default:return false;}};S.prototype._getXPeriodTitle=function(o){var C,k=this.getKey();if(o.length===1){return h.getText("DYNAMIC_DATE_"+k+"_TITLE");}C=o.map(function(O){return h.getText("DYNAMIC_DATE_"+O.toUpperCase());}).join(" / ");if(k.indexOf("LAST")===0){return h.getText("DYNAMIC_DATE_LASTX_TITLE",C);}if(k.indexOf("NEXT")===0){return h.getText("DYNAMIC_DATE_NEXTX_TITLE",C);}};function m(o){return new R({text:h.getText("DYNAMIC_DATE_"+o.toUpperCase())});}return S;});
