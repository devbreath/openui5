/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Core","sap/ui/core/Control","sap/ui/core/InvisibleText","sap/ui/core/EnabledPropagator","sap/ui/core/AccessKeysEnablement","sap/ui/core/LabelEnablement","sap/ui/core/library","sap/ui/Device","./LinkRenderer","sap/ui/events/KeyCodes","sap/base/security/URLListValidator"],function(l,C,a,I,E,A,L,c,D,b,K,U){"use strict";var T=c.TextDirection;var d=c.TextAlign;var e=c.aria.HasPopup;var f=l.LinkAccessibleRole;var g=l.EmptyIndicatorMode;var h=a.extend("sap.m.Link",{metadata:{interfaces:["sap.ui.core.IShrinkable","sap.ui.core.IFormContent","sap.ui.core.ITitleContent","sap.ui.core.IAccessKeySupport"],library:"sap.m",designtime:"sap/m/designtime/Link.designtime",properties:{text:{type:"string",group:"Data",defaultValue:''},enabled:{type:"boolean",group:"Behavior",defaultValue:true},target:{type:"string",group:"Behavior",defaultValue:null},rel:{type:"string",group:"Behavior",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},href:{type:"sap.ui.core.URI",group:"Data",defaultValue:null},validateUrl:{type:"boolean",group:"Data",defaultValue:false},wrapping:{type:"boolean",group:"Appearance",defaultValue:false},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:d.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:T.Inherit},subtle:{type:"boolean",group:"Behavior",defaultValue:false},emphasized:{type:"boolean",group:"Behavior",defaultValue:false},ariaHasPopup:{type:"sap.ui.core.aria.HasPopup",group:"Accessibility",defaultValue:e.None},accessibleRole:{type:"sap.m.LinkAccessibleRole",group:"Accessibility",defaultValue:f.Default},emptyIndicatorMode:{type:"sap.m.EmptyIndicatorMode",group:"Appearance",defaultValue:g.Off},highlightAccKeysRef:{type:"boolean",defaultValue:false,visibility:"hidden"},accesskey:{type:"string",defaultValue:"",visibility:"hidden"}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{allowPreventDefault:true,parameters:{ctrlKey:{type:"boolean"},metaKey:{type:"boolean"}}}},dnd:{draggable:true,droppable:false}}});E.call(h.prototype);h.prototype.init=function(){A.registerControl(this);};h.prototype.onBeforeRendering=function(){};h.prototype.getAccessKeysFocusTarget=function(){return this.getFocusDomRef();};h.prototype.onAccKeysHighlightStart=function(){s.call(this,true);};h.prototype.onAccKeysHighlightEnd=function(){s.call(this,false);};h.prototype.onkeydown=function(o){if(o.which===K.SPACE||o.which===K.SHIFT||o.which===K.ESCAPE){if(o.which===K.SPACE){if(this.getEnabled()||this.getHref()){o.setMarked();o.preventDefault();this._bPressedSpace=true;}}if(this._bPressedSpace&&(o.which===K.ESCAPE||o.which===K.SHIFT)){this._bPressedEscapeOrShift=true;}}else{if(this._bPressedSpace){o.preventDefault();}}};h.prototype.onkeyup=function(o){if(o.which===K.SPACE){if(!this._bPressedEscapeOrShift){this._handlePress(o);if(this.getHref()&&!o.isDefaultPrevented()){o.preventDefault();o.setMarked();var i=document.createEvent('MouseEvents');i.initEvent('click',false,true);this.getDomRef().dispatchEvent(i);}}else{this._bPressedEscapeOrShift=false;}this._bPressedSpace=false;}};h.prototype._handlePress=function(o){if(this.getEnabled()){o.setMarked();if(!this.firePress({ctrlKey:!!o.ctrlKey,metaKey:!!o.metaKey})||!this.getHref()){o.preventDefault();}}else{o.preventDefault();}};h.prototype.onsapenter=h.prototype._handlePress;if(D.support.touch){h.prototype.ontap=h.prototype._handlePress;}else{h.prototype.onclick=h.prototype._handlePress;}h.prototype.ontouchstart=function(o){if(this.getEnabled()){o.setMarked();}};h.prototype.setSubtle=function(S){this.setProperty("subtle",S);if(S&&!h.prototype._sAriaLinkSubtleId){h.prototype._sAriaLinkSubtleId=I.getStaticId("sap.m","LINK_SUBTLE");}return this;};h.prototype.setEmphasized=function(i){this.setProperty("emphasized",i);if(i&&!h.prototype._sAriaLinkEmphasizedId){h.prototype._sAriaLinkEmphasizedId=I.getStaticId("sap.m","LINK_EMPHASIZED");}return this;};h.prototype._isHrefValid=function(u){return this.getValidateUrl()?U.validate(u):true;};h.prototype.getAccessibilityInfo=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.m"),i=this.getEmphasized()?r.getText("LINK_EMPHASIZED"):"",S=this.getSubtle()?r.getText("LINK_SUBTLE"):"",t=this.getText(),j=t,k=this.getAccessibleRole();if(t){i&&(j+=" "+i);S&&(j+=" "+S);}return{role:k===f.Default?"link":k,type:t?r.getText("ACC_CTR_TYPE_LINK"):undefined,description:j,focusable:this.getEnabled(),enabled:this.getEnabled()};};h.prototype.getFormDoNotAdjustWidth=function(){return true;};h.prototype._getTabindex=function(){return(this.getText()&&this.getEnabled())?"0":"-1";};h.prototype._determineSelfReferencePresence=function(){var i=this.getAriaLabelledBy(),j=i.indexOf(this.getId())!==-1,H=L.getReferencingLabels(this).length>0,p=this.getParent(),k=!!(p&&p.enhanceAccessibilityState);return!j&&(i.length>0||H||k);};var s=function(H){var i=this.getAriaLabelledBy();if(i.length){var o=C.byId(i[0]);o.setProperty("highlightAccKeysRef",H);if(o.getText&&o.getText()){this.setProperty("accesskey",o.getText()[0].toLowerCase());}}};return h;});
