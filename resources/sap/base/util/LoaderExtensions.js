/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/util/XMLHelper','sap/base/Log','sap/base/assert','sap/base/util/extend','sap/base/util/mixedFetch'],function(X,L,a,e,m){"use strict";var b={};var K={js:["controller","designtime","fragment","support","view"],json:["fragment","view"],html:["fragment","view"],xml:["fragment","view"]};var r=new RegExp("\\.("+Object.keys(K).join("|")+")$");b.getKnownSubtypes=function(){return K;};b.getAllRequiredModules=function(){var M=[],c=sap.ui.loader._.getAllModules(true),o;for(var s in c){o=c[s];if(o.ui5&&o.state!==-1){M.push(o.ui5);}}return M;};var f=Object.create(null);b.registerResourcePath=function(R,u){if(!u){u={url:null};}if(!f[R]){var U;if(typeof u==="string"||u instanceof String){U=u;}else{U=u.url;if(u.final){f[R]=u.final;}}var o=sap.ui.require.toUrl(R);var c;if(U!==o||u.final){c={paths:{}};c.paths[R]=U;sap.ui.loader.config(c);L.info("LoaderExtensions.registerResourcePath ('"+R+"', '"+U+"')"+(u['final']?" (final)":""));}}else{L.warning("LoaderExtensions.registerResourcePath with prefix "+R+" already set as final. This call is ignored.");}};b.resolveUI5Url=function(u){if(u.startsWith("ui5:")){var n=u.replace("ui5:","");if(!n.startsWith("//")){throw new Error("URLs using the 'ui5' protocol must be absolute. Relative and server absolute URLs are reserved for future use.");}n=n.replace("//","");return sap.ui.loader._.resolveURL(sap.ui.require.toUrl(n));}else{return u;}};b.loadResource=function(R,o){var t,D,u,c=function(){},s;if(b.notifyResourceLoading){c=b.notifyResourceLoading();}if(typeof R==="string"){o=o||{};}else{o=R||{};R=o.name;}o=e({failOnError:true,async:false},o);t=o.dataType;if(t==null&&R){t=(t=r.exec(R||o.url))&&t[1];}a(/^(xml|html|json|text)$/.test(t),"type must be one of xml, html, json or text");function g(d){switch(t){case"json":return JSON.parse(d);case"xml":return X.parse(d);default:return d;}}D=sap.ui.loader._.getModuleContent(R,o.url);if(D!=undefined){D=g(D);if(o.async){return Promise.resolve(D);}else{return D;}}else{s=sap.ui.loader._.getSyncCallBehavior();if(!o.async&&s){if(s>=1){L.error("[nosync] loading resource '"+(R||o.url)+"' with sync XHR");}else{throw new Error("[nosync] loading resource '"+(R||o.url)+"' with sync XHR");}}var h={};if(t){h["Accept"]=m.ContentTypes[t.toUpperCase()];}u=o.url||sap.ui.loader._.getResourcePath(R);var p=m(u,{headers:Object.assign(h,o.headers)},!o.async).then(function(d){if(d.ok){return d.text().then(function(i){return{data:g(i)};});}else{var E=new Error("resource "+R+" could not be loaded from "+u+". Check for 'file not found' or parse errors. Reason: "+d.statusText||d.status);E.status=d.statusText;E.statusCode=d.status;throw E;}}).catch(function(d){return{data:null,error:d};}).then(function(i){c();if(i.data!==null){return i.data;}else if(o.failOnError){L.error(i.error);throw i.error;}else{return null;}});if(o.async){return p;}else{return p.unwrap();}}};b.notifyResourceLoading=null;return b;});
