/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/p13n/Engine","sap/ui/mdc/flexibility/Util"],function(E,U){"use strict";var r=function(c){var e=c&&c.isA&&c.isA("sap.ui.mdc.Table")&&c.isTableBound();var b=c&&c.isA&&(c.isA("sap.ui.mdc.Chart"));if(e||b){if(!c._bWaitForBindChanges){c._bWaitForBindChanges=true;E.getInstance().waitForChanges(c).then(function(){if(e){c.rebind();}else if(b){c.rebind();}delete c._bWaitForBindChanges;});}}};var f=function(c,C,o,i){if(i){c.resetRevertData();}else{c.setRevertData(o);}r(C);};var a=function(c,C,p,s){return new Promise(function(b,d){var i=(s===U.REVERT);var m=p.modifier;var o=i?c.getRevertData():c.getContent();Promise.resolve().then(m.getProperty.bind(m,C,"aggregateConditions")).then(function(e){var g=e?e:{};g[o.name]={};var h={name:o.name};m.setProperty(C,"aggregateConditions",g);f(c,C,h,i);b();}).catch(function(e){d(e);});});};var R=function(c,C,p,s){return new Promise(function(b,d){var i=(s===U.REVERT);var m=p.modifier;var o=i?c.getRevertData():c.getContent();Promise.resolve().then(m.getProperty.bind(m,C,"aggregateConditions")).then(function(e){var v=e?e:{};if(!v){d();}delete v[o.name];m.setProperty(C,"aggregateConditions",v);f(c,C,o,i);b();}).catch(function(e){d(e);});});};var A={};A.addAggregate=U.createChangeHandler({apply:a,revert:R});A.removeAggregate=U.createChangeHandler({apply:R,revert:a});return A;});
