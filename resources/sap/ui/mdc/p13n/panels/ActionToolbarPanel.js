/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/p13n/SelectionPanel","sap/ui/model/Sorter"],function(S,a){"use strict";var A=S.extend("sap.ui.mdc.p13n.panels.ActionToolbarPanel",{metadata:{library:"sap.ui.mdc"},renderer:{apiVersion:2}});A.prototype._bindListItems=function(b){var t=this.getAggregation("_template");if(t){var g=function(c){return c.getProperty("alignment");};var s=new a({path:"alignment",descending:false,group:g});this._oListControl.bindItems(Object.assign({path:this.P13N_MODEL+">/items",sorter:s,key:"name",templateShareable:false,template:this.getAggregation("_template").clone()},b));}};A.prototype._removeFactoryControl=function(){this._oListControl.getItems().filter(function(i){return!i._bGroupHeader;}).forEach(function(i){var f=i.getCells()[0];if(f.getItems().length>1){f.removeItem(f.getItems()[1]);}});this.removeStyleClass("sapUiMDCAFLabelMarkingList");return this._aInitializedFields;};A.prototype._moveTableItem=function(i,n){var I=this._oListControl.getItems();var f=this._getP13nModel().getProperty("/items");var o=f.indexOf(this._getModelEntry(i));n=(n<=0)?0:Math.min(n,I.length-1);var N=f.indexOf(I[n].getBindingContext(this.P13N_MODEL).getObject());if(N==o){return;}f.splice(N,0,f.splice(o,1)[0]);this._getP13nModel().setProperty("/items",f);this._oSelectedItem=this._oListControl.getItems()[n];this._updateEnableOfMoveButtons(this._oSelectedItem,true);this._handleActivated(this._oSelectedItem);this.fireChange({reason:"Move",item:this._getModelEntry(this._oSelectedItem)});};A.prototype._onPressButtonMoveToTop=function(){var i=this._oListControl.getItems().indexOf(this._oHoveredItem);while(!this._oListControl.getItems()[i-1]._bGroupHeader){i--;}this._moveSelectedItem(i);};A.prototype._onPressButtonMoveToBottom=function(){var i=this._oListControl.getItems().indexOf(this._oHoveredItem);while(i<this._oListControl.getItems().length-1&&!this._oListControl.getItems()[i+1]._bGroupHeader){i++;}this._moveSelectedItem(i);};A.prototype._onItemPressed=function(e){var s=e.getParameter('srcControl');if(!this._isControlPartOfMoveButtons(s)){var t=e.getParameter('listItem');this._oSelectedItem=t;var c=t.getBindingContext(this.P13N_MODEL);if(this.getEnableReorder()&&c&&c.getProperty(this.PRESENCE_ATTRIBUTE)){this._handleActivated(t);this._updateEnableOfMoveButtons(t,true);}}};A.prototype._isControlPartOfMoveButtons=function(c){var s=this._oSelectedItem?this._oSelectedItem.getCells()[1].getItems():[];var i=false;if(s.length>2){for(var I=2;I<s.length;I++){if(s[I]==c||s[I]==c.getParent()){i=true;}}}return i;};A.prototype._updateEnableOfMoveButtons=function(t,f){var T=this._oListControl.getItems().indexOf(t);var l=this._oListControl.getItems().length-1;var u=true,d=true;if(T==0){u=false;}if(T==l){d=false;}var L=this._oListControl.getItems().some(function(i){return i._bGroupHeader;});if(L){if(T>0&&this._oListControl.getItems()[T-1]._bGroupHeader){u=false;}if(T<l&&this._oListControl.getItems()[T+1]._bGroupHeader){d=false;}}this._getMoveTopButton().setEnabled(u);this._getMoveUpButton().setEnabled(u);this._getMoveDownButton().setEnabled(d);this._getMoveBottomButton().setEnabled(d);if(f){t.focus();}};return A;});
