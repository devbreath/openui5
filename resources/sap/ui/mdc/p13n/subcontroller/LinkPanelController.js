/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/p13n/P13nBuilder","./BaseController","sap/ui/mdc/p13n/panels/LinkSelectionPanel","sap/m/library","sap/m/MessageBox"],function(P,B,S,l,M){"use strict";var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc");var a=l.MultiSelectMode;var L=B.extend("sap.ui.mdc.p13n.subcontroller.LinkPanelController",{constructor:function(){B.apply(this,arguments);this._bResetEnabled=true;}});L.prototype.getUISettings=function(){return{contentWidth:"28rem",contentHeight:"35rem",reset:{warningText:r.getText("info.SELECTION_DIALOG_RESET_WARNING")},title:r.getText("info.SELECTION_DIALOG_ALIGNEDTITLE")};};L.prototype.getSelectorForReset=function(){return this.getAdaptationControl().getItems().concat(this.getAdaptationControl());};L.prototype.getAdaptationUI=function(p){var s=new S({showHeader:true,fieldColumn:r.getText("info.SELECTION_DIALOG_COLUMNHEADER_WITHOUT_COUNT"),enableCount:true,linkPressed:this._onLinkPressed.bind(this)});var A=this.mixInfoAndState(p);s.setP13nData(A.items);s.setEnableReorder(false);s.setMultiSelectMode(a.Default);this._oPanel=s;return Promise.resolve(s);};L.prototype._onLinkPressed=function(e){var s=e.getParameter("oSource");var p=this.getAdaptationControl();var u=!!(s&&s.getCustomData()&&s.getCustomData()[0].getValue());var h=u?s.getCustomData()[0].getValue():s.getHref();if(p.getBeforeNavigationCallback){p.getBeforeNavigationCallback()(e).then(function(n){if(n){p.getMetadata()._oClass.navigate(h);}});}else{M.show(sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("info.SELECTION_DIALOG_LINK_VALIDATION_QUESTION"),{icon:M.Icon.WARNING,title:sap.ui.getCore().getLibraryResourceBundle("sap.ui.mdc").getText("info.SELECTION_DIALOG_LINK_VALIDATION_TITLE"),actions:[M.Action.YES,M.Action.NO],onClose:function(A){if(A===M.Action.YES){p.getMetadata()._oClass.navigate(h);}},styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""});}};L.prototype._createAddRemoveChange=function(c,o,C){var s=C.name;var b=sap.ui.getCore().byId(s);var d=[];if(!b){d.push({selectorElement:c,changeSpecificData:{changeType:"createItem",content:{selector:s}}});}else{d.push({selectorElement:b,changeSpecificData:{changeType:o==="hideItem"?"hideItem":"revealItem",content:{}}});}return d;};L.prototype.mixInfoAndState=function(p){var i=this.getCurrentState();var e=P.arrayToMap(i);var o=P.prepareAdaptationData(p,function(I,b){var E=e[b.name];I.visible=E?true:false;I.position=E?E.position:-1;I.href=b.href;I.internalHref=b.internalHref;I.description=b.description;I.target=b.target;I.text=b.text;return true;});P.sortP13nData({visible:"visible",position:"position"},o.items);o.presenceAttribute=this._getPresenceAttribute();o.items.forEach(function(I){delete I.position;});return o;};L.prototype._createMoveChange=function(i,p,n,m,c,b){return{selectorElement:c,changeSpecificData:{changeType:m,content:{index:n,name:p}}};};L.prototype.getChangeOperations=function(){return{add:["createItem","revealItem"],remove:"hideItem",move:"moveItem"};};return L;});
