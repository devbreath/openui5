/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Control","./ActionToolbar","./table/TableSettings","./table/GridTableType","./table/ResponsiveTableType","./table/PropertyHelper","./mixin/FilterIntegrationMixin","./library","sap/m/Text","sap/m/Title","sap/m/ColumnHeaderPopover","sap/m/ColumnPopoverSelectListItem","sap/m/OverflowToolbar","sap/m/library","sap/m/table/columnmenu/Menu","sap/ui/core/Core","sap/ui/core/format/NumberFormat","sap/ui/core/dnd/DragDropInfo","sap/ui/core/Item","sap/ui/core/format/ListFormat","sap/ui/core/library","sap/ui/events/KeyCodes","sap/ui/model/Sorter","sap/base/strings/capitalize","sap/base/util/deepEqual","sap/base/util/Deferred","sap/base/util/UriParameters","sap/ui/core/InvisibleMessage","sap/ui/core/InvisibleText","sap/ui/mdc/p13n/subcontroller/ColumnController","sap/ui/mdc/p13n/subcontroller/SortController","sap/ui/mdc/p13n/subcontroller/FilterController","sap/ui/mdc/p13n/subcontroller/GroupController","sap/ui/mdc/p13n/subcontroller/AggregateController","sap/ui/mdc/p13n/subcontroller/ColumnWidthController","sap/ui/mdc/actiontoolbar/ActionToolbarAction","sap/ui/mdc/table/menu/QuickActionContainer","sap/ui/mdc/table/menu/ItemContainer"],function(C,A,T,G,R,P,F,l,a,b,c,d,O,M,e,f,N,D,I,L,g,K,S,h,i,j,U,k,m,n,o,p,q,r,s,t,Q,u){"use strict";var v=l.SelectionMode;var w=l.TableType;var x=l.TableP13nMode;var y=M.ToolbarDesign;var z=M.ToolbarStyle;var B=l.MultiSelectMode;var E=g.TitleLevel;var H=g.SortOrder;var J=new window.WeakMap();var V=function(l1){if(!J.has(l1)){J.set(l1,{oFilterInfoBar:null});}return J.get(l1);};function W(l1,m1){sap.ui.require(["sap/m/MessageToast"],function(n1){var o1=f.getLibraryResourceBundle("sap.ui.mdc");n1.show(o1.getText(l1,m1));});}var X=C.extend("sap.ui.mdc.Table",{metadata:{library:"sap.ui.mdc",designtime:"sap/ui/mdc/designtime/table/Table.designtime",interfaces:["sap.ui.mdc.IFilterSource","sap.ui.mdc.IxState"],defaultAggregation:"columns",properties:{width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null,invalidate:true},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null,invalidate:true},p13nMode:{type:"sap.ui.mdc.TableP13nMode[]",defaultValue:[]},delegate:{type:"object",defaultValue:{name:"sap/ui/mdc/TableDelegate",payload:{}}},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:E.Auto},autoBindOnInit:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},headerVisible:{type:"boolean",group:"Misc",defaultValue:true},selectionMode:{type:"sap.ui.mdc.SelectionMode",defaultValue:v.None},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},threshold:{type:"int",group:"Appearance",defaultValue:-1},noDataText:{type:"string"},sortConditions:{type:"object"},filterConditions:{type:"object",defaultValue:{}},groupConditions:{type:"object"},aggregateConditions:{type:"object"},enableExport:{type:"boolean",defaultValue:false},busyIndicatorDelay:{type:"int",defaultValue:100},enableColumnResize:{type:"boolean",group:"Behavior",defaultValue:true},showPasteButton:{type:"boolean",group:"Behavior",defaultValue:false},enablePaste:{type:"boolean",group:"Behavior",defaultValue:true},multiSelectMode:{type:"sap.ui.mdc.MultiSelectMode",group:"Behavior",defaultValue:B.Default},enableAutoColumnWidth:{type:"boolean",group:"Behavior",defaultValue:false}},aggregations:{_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},type:{type:"sap.ui.mdc.table.TableTypeBase",altTypes:["sap.ui.mdc.TableType"],multiple:false},columns:{type:"sap.ui.mdc.table.Column",multiple:true},creationRow:{type:"sap.ui.mdc.table.CreationRow",multiple:false},actions:{type:"sap.ui.core.Control",multiple:true,forwarding:{getter:"_createToolbar",aggregation:"actions"}},variant:{type:"sap.ui.fl.variants.VariantManagement",multiple:false},quickFilter:{type:"sap.ui.core.Control",multiple:false},rowSettings:{type:"sap.ui.mdc.table.RowSettings",multiple:false},dataStateIndicator:{type:"sap.m.plugins.DataStateIndicator",multiple:false}},associations:{filter:{type:"sap.ui.mdc.IFilter",multiple:false}},events:{rowPress:{parameters:{bindingContext:{type:"sap.ui.model.Context"}}},selectionChange:{parameters:{bindingContext:{type:"sap.ui.model.Context"},selected:{type:"boolean"},selectAll:{type:"boolean"}}},beforeExport:{parameters:{exportSettings:{type:"object"},userExportSettings:{type:"object"}}},paste:{parameters:{data:{type:"string[][]"}}}}},constructor:function(){this._oTableReady=new j();this._oFullInitialize=new j();this._bUseColumnMenu=U.fromQuery(window.location.search).get("sap-ui-xx-columnmenu")==="true";C.apply(this,arguments);this.bCreated=true;this._doOneTimeOperations();this._initializeContent();},renderer:{apiVersion:2,render:function(l1,m1){l1.openStart("div",m1);l1.class("sapUiMdcTable");l1.style("height",m1.getHeight());l1.style("width",m1.getWidth());l1.openEnd();l1.renderControl(m1.getAggregation("_content"));l1.close("div");}}});var Y=["variant","quickFilter"];F.call(X.prototype);Y.forEach(function(l1){var m1=h(l1),n1="_o"+m1,o1="get"+m1,p1="set"+m1,q1="destroy"+m1;X.prototype[o1]=function(){return this[n1];};X.prototype[q1]=function(){var r1=this[n1];this[p1]();if(r1){r1.destroy();}return this;};X.prototype[p1]=function(r1){this.validateAggregation(l1,r1,false);var s1=this._createToolbar(),t1=r1!==this[n1];if(!r1||t1){s1.removeBetween((this[o1]()));this[n1]=r1;}if(t1&&r1){this._setToolbarBetween(s1);}return this;};});X.prototype.init=function(){C.prototype.init.apply(this,arguments);this.mSkipPropagation={rowSettings:true};this._bForceRebind=true;this._aSupportedP13nModes=Object.keys(x);this._updateAdaptation();};X.prototype.applySettings=function(){this._setPropertyHelperClass(P);C.prototype.applySettings.apply(this,arguments);this.initControlDelegate();};X.prototype._setToolbarBetween=function(l1){[this._oVariant,this._oQuickFilter].forEach(function(m1){if(m1){l1.addBetween(m1);}});};X.prototype.initialized=function(){return this._oTableReady.promise;};X.prototype._fullyInitialized=function(){return this._oFullInitialize.promise;};X.prototype.getDataStateIndicatorPluginOwner=function(l1){return this._oTable||this._oFullInitialize.promise;};X.prototype.setDataStateIndicator=function(l1){this._handleDataStateEvents(this.getDataStateIndicator(),"detach");this.setAggregation("dataStateIndicator",l1,true);this._handleDataStateEvents(this.getDataStateIndicator(),"attach");return this;};X.prototype._handleDataStateEvents=function(l1,m1){if(l1){l1[m1+"ApplyFilter"](this._onApplyMessageFilter,this);l1[m1+"ClearFilter"](this._onClearMessageFilter,this);l1[m1+"Event"]("filterInfoPress",k1,this);}};X.prototype._onApplyMessageFilter=function(l1){this._oMessageFilter=l1.getParameter("filter");l1.preventDefault();this._rebind();};X.prototype._onClearMessageFilter=function(l1){this._oMessageFilter=null;l1.preventDefault();this._rebind();};X.prototype._getStringType=function(l1){var m1,n1=m1=l1||this.getType();if(!n1){m1=w.Table;}else if(typeof n1==="object"){if(n1.isA("sap.ui.mdc.table.ResponsiveTableType")){m1=w.ResponsiveTable;}else{m1=w.Table;}}return m1;};X.prototype._isOfType=function(l1){return this._getStringType()===l1;};X.prototype._updateTypeSettings=function(){var l1=this.getType();if(l1&&typeof l1==="object"){l1.updateTableSettings();}else{if(l1==="ResponsiveTable"){l1=R;}else{l1=G;}l1.updateDefault(this._oTable);}};X.prototype.scrollToIndex=function(l1){return new Promise(function(m1,n1){if(!this._oTable){return n1();}if(typeof l1!=="number"){return n1("The iIndex parameter has to be a number");}if(this._isOfType(w.ResponsiveTable)){this._oTable.scrollToIndex(l1).then(m1).catch(n1);}else{if(l1===-1){l1=this._getRowCount(false);}if(this._oTable._setFirstVisibleRowIndex(l1)){this._oTable.attachEventOnce("rowsUpdated",function(){m1();});}else{m1();}}}.bind(this));};X.prototype.focusRow=function(l1,m1){return this.scrollToIndex(l1).then(function(){return this._oTable._setFocus(l1,m1);}.bind(this));};X.prototype.setType=function(l1){var m1=this._getStringType(l1);var n1=this._getStringType();this.setAggregation("type",l1,true);if(m1===n1&&this._oTable){this._updateTypeSettings();return this;}if(this.bCreated){if(this._oTable){if(n1==="ResponsiveTable"){this._oTable.setHeaderToolbar();}else{this._oTable.removeExtension(this._oToolbar);}this._oTable.destroy("KeepDom");this._oTable=null;this._bTableExists=false;}else{this._onAfterTableCreated();this._onAfterFullInitialization();}if(this._oTemplate){this._oTemplate.destroy();this._oTemplate=null;}this._oTableReady=new j();this._oFullInitialize=new j();this._bFullyInitialized=false;this._initializeContent();}return this;};X.prototype.setRowSettings=function(l1){this.setAggregation("rowSettings",l1,true);if(this._oTable){this._oRowActions={};if(this._isOfType(w.ResponsiveTable)){R.updateRowSettings(this,l1,this._onResponsiveRowActionPress);}else{G.updateRowSettings(this._oTable,l1,[this._onRowActionPress,this]);}this._bForceRebind=true;this._rebind();}return this;};X.prototype.setHeaderLevel=function(l1){if(this.getHeaderLevel()===l1){return this;}this.setProperty("headerLevel",l1,true);this._oTitle&&this._oTitle.setLevel(l1);return this;};X.prototype.focus=function(l1){if(this._oTable){this._oTable.focus(l1);}};X.prototype.setBusy=function(l1){this.setProperty('busy',l1,true);if(this._oTable){this._oTable.setBusy(l1);}return this;};X.prototype.setBusyIndicatorDelay=function(l1){this.setProperty('busyIndicatorDelay',l1,true);if(this._oTable){this._oTable.setBusyIndicatorDelay(l1);}return this;};X.prototype.setSelectionMode=function(l1){var m1=this.getSelectionMode();this.setProperty("selectionMode",l1,true);if(this._oTable&&m1!=this.getSelectionMode()){this._updateSelectionBehavior();}return this;};X.prototype.setMultiSelectMode=function(l1){var m1=this.getMultiSelectMode();this.setProperty("multiSelectMode",l1,true);if(this._oTable&&m1!=this.getMultiSelectMode()){this._updateMultiSelectMode();}return this;};X.prototype.setCreationRow=function(l1){this.setAggregation("creationRow",l1,true);if(l1){l1.update();}return this;};X.prototype.setEnableColumnResize=function(l1){var m1=this.getEnableColumnResize();this.setProperty("enableColumnResize",l1,true);if(this.getEnableColumnResize()!==m1){this._updateColumnResizer();this._updateAdaptation();}return this;};X.prototype._onModifications=function(){this.getColumns().forEach(function(l1){l1._onModifications();});};X.prototype.setP13nMode=function(l1){var m1=this.getP13nMode();var n1=[];if(l1&&l1.length>1){var o1=l1.reduce(function(p1,q1,r1){p1[q1]=true;return p1;},{});if(o1.Column){n1.push("Column");}if(o1.Sort){n1.push("Sort");}if(o1.Filter){n1.push("Filter");}if(o1.Group){n1.push("Group");}if(o1.Aggregate){n1.push("Aggregate");}}else{n1=l1;}this.setProperty("p13nMode",n1,true);this._updateAdaptation();if(!i(m1.sort(),this.getP13nMode().sort())){Z(this);}return this;};X.prototype._updateAdaptation=function(){var l1={controller:{}};var m1={Column:n,Sort:o,Group:q,Filter:p,Aggregate:r,ColumnWidth:s};this.getActiveP13nModes().forEach(function(n1){l1.controller[n1]=m1[n1];});if(this.getEnableColumnResize()){l1.controller["ColumnWidth"]=m1["ColumnWidth"];}this.getEngine().registerAdaptation(this,l1);};function Z(l1){if(l1._oToolbar){l1._oToolbar.destroyEnd();l1._getP13nButtons().forEach(function(n1){l1._oToolbar.addEnd(n1);});}if(l1._oTable){var m1=l1._oTable.getDragDropConfig()[0];if(m1){m1.setEnabled(l1.getActiveP13nModes().indexOf("Column")>-1);}}if(l1.isFilteringEnabled()){_(l1);}$(l1);}X.prototype.setFilterConditions=function(l1){this.setProperty("filterConditions",l1,true);var m1=this.getInbuiltFilter();if(m1){m1.setFilterConditions(l1);}$(this);return this;};function $(l1){var m1=c1(l1);var n1=d1(l1);var o1=e1(l1);if(!m1){return;}if(o1.length===0){var p1=m1.getDomRef();if(p1&&p1.contains(document.activeElement)){l1.focus();}m1.setVisible(false);a1(l1).setText("");return;}l1._fullyInitialized().then(function(){var q1=l1.getPropertyHelper();var r1=o1.map(function(v1){return q1.hasProperty(v1)?q1.getProperty(v1).label:"";});var s1=f.getLibraryResourceBundle("sap.ui.mdc");var t1=L.getInstance();var u1;if(r1.length>1){u1=s1.getText("table.MULTIPLE_FILTERS_ACTIVE",[r1.length,t1.format(r1)]);}else{u1=s1.getText("table.ONE_FILTER_ACTIVE",r1[0]);}if(!m1.getVisible()){m1.setVisible(true);}n1.setText(u1);a1(l1).setText(u1);});}function _(l1){if(!l1._oTable){return;}var m1=c1(l1);if(!m1){m1=b1(l1);}if(l1._bMobileTable){if(l1._oTable.getInfoToolbar()!==m1){l1._oTable.setInfoToolbar(m1);}}else if(l1._oTable.indexOfExtension(m1)===-1){l1._oTable.insertExtension(m1,1);}var n1=a1(l1);l1._oTable.addAriaLabelledBy(n1.getId());}function a1(l1){if(!l1){return null;}if(!l1._oFilterInfoBarInvisibleText){l1._oFilterInfoBarInvisibleText=new m().toStatic();}return l1._oFilterInfoBarInvisibleText;}function b1(l1){var m1=l1.getId()+"-filterInfoBar";var n1=V(l1).oFilterInfoBar;if(n1&&!n1.bIsDestroyed){n1.destroy();}n1=new O({id:m1,active:true,design:y.Info,visible:false,content:[new a({id:m1+"-text",wrapping:false})],press:[k1,l1]});n1.focus=function(){if(this.getDomRef()){O.prototype.focus.apply(this,arguments);}else{l1.focus();}};V(l1).oFilterInfoBar=n1;$(l1);return n1;}function c1(l1){var m1=V(l1).oFilterInfoBar;if(m1&&(m1.bIsDestroyed||m1.bIsBeingDestroyed)){return null;}return V(l1).oFilterInfoBar;}function d1(l1){var m1=c1(l1);return m1?m1.getContent()[0]:null;}X.prototype.setThreshold=function(l1){this.setProperty("threshold",l1,true);if(!this._oTable){return this;}l1=this.getThreshold()>-1?this.getThreshold():undefined;if(this._bMobileTable){this._oTable.setGrowingThreshold(l1);}else{this._oTable.setThreshold(l1);}return this;};X.prototype._onFilterProvided=function(l1){this._updateInnerTableNoDataText();};X.prototype._onFilterRemoved=function(l1){this._updateInnerTableNoDataText();};X.prototype._onFiltersChanged=function(l1){if(this.isTableBound()&&l1.getParameter("conditionsBased")){this._oTable.setShowOverlay(true);}};X.prototype._onFilterSearch=function(l1){this._bIgnoreChange=true;this._bAnnounceTableUpdate=true;};X.prototype.setNoDataText=function(l1){this.setProperty("noDataText",l1,true);this._updateInnerTableNoDataText();return this;};X.prototype._updateInnerTableNoDataText=function(){if(!this._oTable){return;}var l1=this._getNoDataText();if(this._bMobileTable){this._oTable.setNoDataText(l1);}else{this._oTable.setNoData(l1);}};X.prototype._getNoDataText=function(){var l1=this.getNoDataText();if(l1){return l1;}var m1=f.getLibraryResourceBundle("sap.ui.mdc");if(!this.isTableBound()){if(this.getFilter()){return m1.getText("table.NO_DATA_WITH_FILTERBAR");}return m1.getText("table.NO_DATA");}if(g1(this)){return m1.getText("table.NO_RESULTS");}return m1.getText("table.NO_DATA");};X.prototype._updateRowAction=function(){if(!this._oTable){return;}var l1=this._bMobileTable?R:G;l1.updateRowActions(this,this.getRowSettings(),this._bMobileTable?this._onResponsiveRowActionPress:this._onRowActionPress);};X.prototype._initializeContent=function(){var l1,m1=this._getStringType();if(this._isOfType(w.ResponsiveTable)){l1=R;}else{l1=G;}var n1=[this.awaitControlDelegate(),l1.loadTableModules()];if(this.isFilteringEnabled()){n1.push(this.retrieveInbuiltFilter());}Promise.all(n1).then(function(){if(this.bIsDestroyed){return;}var o1=this.getControlDelegate();this._aSupportedP13nModes=o1.getSupportedP13nModes(this);this._updateAdaptation();if(o1.preInit){this._pDelegatePreInit=o1.preInit(this);}if(!this._bTableExists&&m1===this._getStringType()){this._bMobileTable=m1==="ResponsiveTable";this._createContent();this._bTableExists=true;}}.bind(this)).catch(function(o1){this._onAfterTableCreated();throw o1;}.bind(this));};X.prototype._doOneTimeOperations=function(){if(!this.bColumnsOrdered){this.bColumnsOrdered=true;this._orderColumns();}};X.prototype._onAfterTableCreated=function(l1){this._oTableReady[l1?"resolve":"reject"](this);};X.prototype._onAfterFullInitialization=function(l1){this._oFullInitialize[l1?"resolve":"reject"](this);};X.prototype._createContent=function(){this._createToolbar();this._createTable();this._updateColumnResizer();this._updateRowAction();this.getColumns().forEach(this._insertInnerColumn,this);this.setAggregation("_content",this._oTable);this._onAfterTableCreated(true);var l1=this.initialized().then(function(){this.initPropertyHelper();var m1=this.getCreationRow();if(m1){m1.update();}if(this.getAutoBindOnInit()){this.rebind();}return this.awaitPropertyHelper();}.bind(this));Promise.all([l1,this._pDelegatePreInit]).then(function(){delete this._pDelegatePreInit;this._bFullyInitialized=true;this._onAfterFullInitialization(true);}.bind(this)).catch(function(m1){this._onAfterFullInitialization();throw m1;}.bind(this));};X.prototype.setHeader=function(l1){this.setProperty("header",l1,true);this._updateHeaderText();this._updateExportState(true);return this;};X.prototype.setHeaderVisible=function(l1){this.setProperty("headerVisible",l1,true);if(this._oTitle){this._oTitle.setWidth(this.getHeaderVisible()?undefined:"0px");}return this;};X.prototype.setShowRowCount=function(l1){this.setProperty("showRowCount",l1,true);this._updateHeaderText();return this;};X.prototype.setEnableExport=function(l1){if(l1!==this.getEnableExport()){this.setProperty("enableExport",l1,true);if(l1&&!this._oExportButton&&this._oToolbar){this._oToolbar.addEnd(this._getExportButton());}else if(this._oExportButton){this._oExportButton.setVisible(l1);}}return this;};X.prototype.setShowPasteButton=function(l1){if((l1=!!l1)==this.getShowPasteButton()){return this;}this.setProperty("showPasteButton",l1,true);if(l1&&!this._oPasteButton&&this._oToolbar){this._oToolbar.insertEnd(this._getPasteButton(),0);this._oPasteButton.setEnabled(this.getEnablePaste());}else if(this._oPasteButton){this._oPasteButton.setVisible(l1);this._oPasteButton.setEnabled(this.getEnablePaste());}return this;};X.prototype.setEnablePaste=function(l1){this.setProperty("enablePaste",l1,true);if(this._oPasteButton){this._oPasteButton.setEnabled(this.getEnablePaste());}return this;};X.prototype._createToolbar=function(){if(this.isDestroyStarted()||this.isDestroyed()){return;}if(!this._oToolbar){this._oTitle=new b(this.getId()+"-title",{text:this.getHeader(),width:this.getHeaderVisible()?undefined:"0px",level:this.getHeaderLevel()});this._oToolbar=new A(this.getId()+"-toolbar",{design:y.Transparent,begin:[this._oTitle],end:[this._getPasteButton(),this._getP13nButtons(),this._getExportButton()]});}this._oToolbar.setStyle(this._bMobileTable?z.Standard:z.Clear);return this._oToolbar;};X.prototype._getVisibleProperties=function(){var l1=[],m1;this.getColumns().forEach(function(n1,o1){m1=n1&&n1.getDataProperty();if(m1){l1.push({name:m1});}});return l1;};X.prototype.getConditions=function(){return this.getInbuiltFilter()?this.getInbuiltFilter().getConditions():[];};X.prototype._getSortedProperties=function(){return this.getSortConditions()?this.getSortConditions().sorters:[];};X.prototype._getGroupedProperties=function(){return this.getGroupConditions()?this.getGroupConditions().groupLevels:[];};X.prototype._getAggregatedProperties=function(){return this.getAggregateConditions()?this.getAggregateConditions():{};};X.prototype._getXConfig=function(){return this.getEngine().readXConfig(this);};function e1(l1){return l1.isFilteringEnabled()?h1(l1.getFilterConditions()):[];}function f1(l1){var m1=f.byId(l1.getFilter());return m1?h1(m1.getConditions()):[];}function g1(l1){var m1=f.byId(l1.getFilter());return e1(l1).length>0||f1(l1).length>0||m1&&m1.getSearch()!=="";}function h1(l1){return Object.keys(l1||{}).filter(function(m1){return l1[m1].length>0;});}X.prototype.getCurrentState=function(){var l1={};var m1=this.getActiveP13nModes();if(m1.indexOf("Column")>-1){l1.items=this._getVisibleProperties();}if(this.isSortingEnabled()){l1.sorters=this._getSortedProperties();}if(this.isFilteringEnabled()){l1.filter=this.getFilterConditions();}if(this.isGroupingEnabled()){l1.groupLevels=this._getGroupedProperties();}if(this.isAggregationEnabled()){l1.aggregations=this._getAggregatedProperties();}if(this.getEnableColumnResize()){l1.xConfig=this._getXConfig();}return l1;};X.prototype.isFilteringEnabled=function(){return this.getActiveP13nModes().includes(x.Filter);};X.prototype.isSortingEnabled=function(){return this.getActiveP13nModes().includes(x.Sort);};X.prototype.isGroupingEnabled=function(){return this.getActiveP13nModes().includes(x.Group);};X.prototype.isAggregationEnabled=function(){return this.getActiveP13nModes().includes(x.Aggregate);};X.prototype.getSupportedP13nModes=function(){return this._aSupportedP13nModes||[];};X.prototype.getActiveP13nModes=function(){var l1=this.getP13nMode();var m1=this.getSupportedP13nModes();l1=l1.filter(function(n1){return m1.includes(n1);});return l1;};X.prototype._getP13nButtons=function(){var l1=this.getActiveP13nModes();var m1=[];var n1=l1.length===1&&l1[0]==="Aggregate";if(l1.length>0&&!n1){m1.push(T.createSettingsButton(this.getId(),[j1,this]));}return m1;};X.prototype._getPasteButton=function(){if(this.getShowPasteButton()){if(!this._oPasteButton){this._oPasteButton=T.createPasteButton(this.getId());}return this._oPasteButton;}};X.prototype._getExportButton=function(){if(!this.getEnableExport()){return null;}if(!this._oExportButton){this._oExportButton=T.createExportButton(this.getId(),{"default":[function(){this._onExport();},this],"exportAs":[function(){this._onExport(true);},this]});}this._updateExportState();return this._oExportButton;};X.prototype._updateExportState=function(l1){if(this._oExportButton){this._oExportButton.setEnabled(this._getRowCount(false)>0);if(l1&&this._cachedExportSettings){this._cachedExportSettings.fileName=this.getHeader();}}};X.prototype._createExportColumnConfiguration=function(){var l1=this.getColumns();return this._fullyInitialized().then(function(){var m1=this.getPropertyHelper();var n1=[];l1.forEach(function(o1){var p1=m1.getColumnExportSettings(o1);n1=n1.concat(p1);},this);return n1;}.bind(this));};X.prototype._getColumnLabel=function(l1){var m1=this.getPropertyHelper();var n1=m1.getProperty(l1);return n1&&n1.label;};X.prototype._onExport=function(l1){var m1=this;return this._createExportColumnConfiguration().then(function(n1){if(!n1||!n1.length){sap.ui.require(["sap/m/MessageBox"],function(r1){r1.error(f.getLibraryResourceBundle("sap.ui.mdc").getText("table.NO_COLS_EXPORT"),{styleClass:(this.$()&&this.$().closest(".sapUiSizeCompact").length)?"sapUiSizeCompact":""});}.bind(m1));return;}var o1=m1._getRowBinding();var p1=m1._getColumnLabel.bind(m1);var q1={workbook:{columns:n1,context:{title:m1.getHeader()}},dataSource:o1,fileName:m1.getHeader()};m1._loadExportLibrary().then(function(){sap.ui.require(["sap/ui/export/ExportHandler"],function(r1){var s1;m1.getControlDelegate().fetchExportCapabilities(m1).then(function(t1){if(!m1._oExportHandler){s1=new r1(t1);s1.attachBeforeExport(function(u1){m1.fireBeforeExport({exportSettings:u1.getParameter('exportSettings'),userExportSettings:u1.getParameter('userExportSettings')});});m1._oExportHandler=s1;}if(l1){m1._oExportHandler.exportAs(q1,p1);}else{m1._oExportHandler.export(q1,p1);}});});});});};X.prototype._loadExportLibrary=function(){if(!this._oExportLibLoadPromise){this._oExportLibLoadPromise=f.loadLibrary("sap.ui.export",true);}return this._oExportLibLoadPromise;};X.prototype.onkeydown=function(l1){if(l1.isMarked()){return;}if((l1.metaKey||l1.ctrlKey)&&l1.shiftKey&&l1.which===K.E){if(this.getEnableExport()&&this._oExportButton&&this._oExportButton.getEnabled()){this._onExport(true);l1.setMarked();l1.preventDefault();}}if((l1.metaKey||l1.ctrlKey)&&l1.which===K.COMMA){var m1=f.byId(this.getId()+"-settings");if(m1&&m1.getEnabled()&&m1.getVisible()){m1.firePress();l1.setMarked();l1.preventDefault();}}};X.prototype._createTable=function(){var l1=this.getThreshold()>-1?this.getThreshold():undefined;var m1=this.getRowSettings()?this.getRowSettings().getAllSettings():{};if(this._bMobileTable){this._oTable=R.createTable(this.getId()+"-innerTable",{autoPopinMode:true,contextualWidth:"Auto",growing:true,sticky:["ColumnHeaders","HeaderToolbar","InfoToolbar"],itemPress:[this._onItemPress,this],selectionChange:[this._onSelectionChange,this],growingThreshold:l1,noDataText:this._getNoDataText(),headerToolbar:this._oToolbar,ariaLabelledBy:[this._oTitle]});this._oTemplate=R.createTemplate(this.getId()+"-innerTableRow",m1);this._sAggregation="items";this._oTable.bindRows=this._oTable.bindItems;this._oTable.bActiveHeaders=true;this._oTable.attachEvent("columnPress",this._onResponsiveTableColumnPress,this);}else{this._oTable=G.createTable(this.getId()+"-innerTable",{enableBusyIndicator:true,enableColumnReordering:false,threshold:l1,cellClick:[this._onCellClick,this],noData:this._getNoDataText(),extension:[this._oToolbar],ariaLabelledBy:[this._oTitle],plugins:[G.createMultiSelectionPlugin(this,[this._onRowSelectionChange,this])],columnSelect:[this._onGridTableColumnPress,this],rowSettingsTemplate:m1});this._sAggregation="rows";}this._updateTypeSettings();this._updateSelectionBehavior();this._updateMultiSelectMode();var n1=new D({sourceAggregation:"columns",targetAggregation:"columns",dropPosition:"Between",enabled:this.getActiveP13nModes().includes(x.Column),drop:[this._onColumnRearrange,this]});n1.bIgnoreMetadataCheck=true;this._oTable.addDragDropConfig(n1);this._oTable.setBusyIndicatorDelay(this.getBusyIndicatorDelay());this._oTable.attachPaste(this._onInnerTablePaste,this);if(this.isFilteringEnabled()){_(this);}};X.prototype._updateColumnResizer=function(){if(!this._oTable){return;}var l1=this.getEnableColumnResize();var m1=this._bMobileTable?R:G;if(l1){m1.enableColumnResizer(this,this._oTable);}else{m1.disableColumnResizer(this,this._oTable);}};X.prototype._updateSelectionBehavior=function(){var l1=this._bMobileTable?R:G;l1.updateSelection(this);};X.prototype._updateMultiSelectMode=function(){if(this._bMobileTable){R.updateMultiSelectMode(this);}};X.prototype._onColumnRearrange=function(l1){var m1=l1.getParameter("draggedControl");var n1=l1.getParameter("droppedControl");if(m1===n1){return;}var o1=l1.getParameter("dropPosition");var p1=this._oTable.indexOfColumn(m1);var q1=this._oTable.indexOfColumn(n1);var r1=q1+(o1=="Before"?0:1)+(p1<q1?-1:0);T.moveColumn(this,p1,r1);};X.prototype._onColumnPress=function(l1){if(this._bSuppressOpenMenu){return;}var m1=l1.getParent(),n1=m1.indexOfColumn(l1),o1=this.getColumns()[n1];this._fullyInitialized().then(function(){if(this._bUseColumnMenu){if(!this._oColumnHeaderMenu){this._oQuickActionContainer=new Q({table:this});this._oItemContainer=new u({table:this});this._oColumnHeaderMenu=new e({_quickActions:[this._oQuickActionContainer],_items:[this._oItemContainer]});}this._oQuickActionContainer.setAssociation("column",o1);Promise.all([this._oQuickActionContainer.initializeQuickActions(),this._oItemContainer.initializeItems()]).then(function(){if(this._oQuickActionContainer.hasQuickActions()||this._oItemContainer.hasItems()){this._oColumnHeaderMenu.openBy(l1);}}.bind(this));}else{var p1=f.getLibraryResourceBundle("sap.ui.mdc"),q1=this._bMobileTable&&this.getEnableColumnResize();if(this._oPopover){this._oPopover.destroy();this._oPopover=null;}if(this.isSortingEnabled()){var r1=[],s1=[];var t1=this.getPropertyHelper().getProperty(o1.getDataProperty()).getSortableProperties();t1.forEach(function(z1){r1.push(new I({text:z1.label,key:z1.name}));s1.push(new I({text:z1.label,key:z1.name}));});if(r1.length>0){this._oPopover=new c({items:[new d({items:r1,label:p1.getText("table.SETTINGS_ASCENDING"),icon:"sap-icon://sort-ascending",action:[H.Ascending,this._onCustomSort,this]}),new d({items:s1,label:p1.getText("table.SETTINGS_DESCENDING"),icon:"sap-icon://sort-descending",action:[H.Descending,this._onCustomSort,this]})]});l1.addDependent(this._oPopover);}}var u1=[];var v1=this.getControlDelegate();var w1=(v1.addColumnMenuItems&&v1.addColumnMenuItems(this,o1))||[];this.getPropertyHelper().getFilterableProperties(o1.getDataProperty()).forEach(function(z1){u1.push(new I({text:z1.label,key:z1.name}));});if(this.isFilteringEnabled()&&u1.length){var x1=new d({label:p1.getText("table.SETTINGS_FILTER"),icon:"sap-icon://filter",action:[k1,this]});w1.unshift(x1);}if(q1){var y1=R.startColumnResize(this._oTable,l1);y1&&w1.push(y1);}w1.forEach(function(z1){this._createPopover(z1,l1);},this);this._oPopover&&this._oPopover.openBy(l1);}}.bind(this));};X.prototype._createPopover=function(l1,m1){if(this._oPopover){this._oPopover.addItem(l1);}else{this._oPopover=new c({items:l1});m1.addDependent(this._oPopover);}};X.prototype._onCustomSort=function(l1,m1){var n1=l1.getParameter("property");this.getCurrentState().sorters.forEach(function(o1){if(o1.name===n1){if(o1.descending&&m1===H.Descending||!o1.descending&&m1===H.Ascending){m1=H.None;}}});T.createSort(this,n1,m1,true);};X.prototype._onColumnResize=function(l1){var m1=l1.getParameter("column");var n1=l1.getParameter("width");var o1=this._oTable.indexOfColumn(m1);var p1=this.getColumns()[o1];var q1=p1.getDataProperty();T.createColumnWidth(this,q1,n1);};X.prototype._onCustomGroup=function(l1){T.createGroup(this,l1);};X.prototype._onCustomAggregate=function(l1){T.createAggregation(this,l1);};X.prototype._insertInnerColumn=function(l1,m1){if(!this._oTable){return;}var n1=l1.getInnerColumn();this._setMobileColumnTemplate(l1,m1);this._bForceRebind=true;if(m1===undefined){this._oTable.addColumn(n1);}else{this._oTable.insertColumn(n1,m1);}};X.prototype._orderColumns=function(){var l1,m1=[],n1=this.getColumns();n1.forEach(function(o1){l1=o1.getInitialIndex();if(l1>-1){m1.push({index:l1,column:this.removeColumn(o1)});}},this);m1.sort(function(o1,p1){return o1-p1;});m1.forEach(function(o1){this.insertColumn(o1.column,o1.index);},this);};X.prototype.moveColumn=function(l1,m1){l1._bIsBeingMoved=true;this.removeAggregation("columns",l1,true);this.insertAggregation("columns",l1,m1,true);delete l1._bIsBeingMoved;if(this._oTable){var n1=l1.getInnerColumn();this._oTable.removeColumn(n1);this._oTable.insertColumn(n1,m1);this._setMobileColumnOrder();this._updateMobileColumnTemplate(l1,m1);}};X.prototype.removeColumn=function(l1){l1=this.removeAggregation("columns",l1,true);this._updateMobileColumnTemplate(l1,-1);return l1;};X.prototype.addColumn=function(l1){this.addAggregation("columns",l1,true);this._insertInnerColumn(l1);return this;};X.prototype.insertColumn=function(l1,m1){this.insertAggregation("columns",l1,m1,true);this._insertInnerColumn(l1,m1);return this;};X.prototype._setMobileColumnTemplate=function(l1,m1){if(!this._bMobileTable){return;}var n1=l1.getTemplateClone();if(m1>=0){this._oTemplate.insertCell(n1,m1);this._oTable.getItems().forEach(function(o1){if(o1.isA("sap.m.GroupHeaderListItem")){return;}o1.insertAggregation("cells",new m(),m1,true);});}else{this._oTemplate.addCell(n1);}};X.prototype._updateMobileColumnTemplate=function(l1,m1){if(!this._bMobileTable){return;}var n1,o1;if(this._oTemplate){n1=l1.getTemplateClone();o1=this._oTemplate.indexOfCell(n1);i1(this._oTemplate,o1,m1);}if(o1>-1){this._oTable.getItems().forEach(function(p1){if(p1.removeCell){i1(p1,o1,m1);}});}};X.prototype._setMobileColumnOrder=function(){if(!this._bMobileTable){return;}this.getColumns().forEach(function(l1){var m1=l1.getInnerColumn();if(!m1){return;}m1.setOrder(this.indexOfColumn(l1));},this);this._oTable.invalidate();};function i1(l1,m1,n1){var o1=l1.removeCell(m1);if(o1){if(n1>-1){l1.insertCell(o1,n1);}else{o1.destroy();}}}X.prototype._onItemPress=function(l1){if(this.getSelectionMode()!==l.SelectionMode.SingleMaster){this.fireRowPress({bindingContext:l1.getParameter("listItem").getBindingContext()});}R._onRowActionPress.apply(this,[l1]);};X.prototype._onSelectionChange=function(l1){var m1=l1.getParameter("selectAll");this.fireSelectionChange({bindingContext:l1.getParameter("listItem").getBindingContext(),selected:l1.getParameter("selected"),selectAll:m1});if(m1){var n1=this.getRowBinding();if(n1&&this._oTable){var o1=n1.getLength();var p1=this._oTable.getItems().filter(function(r1){return!r1.isGroupHeader();}).length;var q1=n1.isLengthFinal();if(p1!=o1||!q1){W("table.SELECTION_LIMIT_MESSAGE",[p1]);}}}};X.prototype._onResponsiveTableColumnPress=function(l1){this._onColumnPress(l1.getParameter("column"));};X.prototype._onCellClick=function(l1){if(this.getSelectionMode()===l.SelectionMode.SingleMaster){return;}this.fireRowPress({bindingContext:l1.getParameter("rowBindingContext")});};X.prototype._onRowSelectionChange=function(l1){if(!this._bSelectionChangedByAPI){this.fireSelectionChange({bindingContext:l1.getParameter("rowContext"),selected:l1.getSource().isIndexSelected(l1.getParameter("rowIndex")),selectAll:l1.getParameter("selectAll")});}};X.prototype._onGridTableColumnPress=function(l1){l1.preventDefault();this._onColumnPress(l1.getParameter("column"));};X.prototype.getSelectedContexts=function(){if(this._oTable){if(this._bMobileTable){return this._oTable.getSelectedContexts();}var l1=this._oTable.getPlugins()[0].getSelectedIndices();return l1.map(function(m1){return this._oTable.getContextByIndex(m1);},this);}return[];};X.prototype.clearSelection=function(){if(this._oTable){if(this._bMobileTable){this._oTable.removeSelections(true);}else{this._bSelectionChangedByAPI=true;this._oTable.getPlugins()[0].clearSelection();this._bSelectionChangedByAPI=false;}}};X.prototype._registerInnerFilter=function(l1){l1.attachSearch(function(){this._rebind();},this);};X.prototype.isTableBound=function(){return this._oTable?this._oTable.isBound(this._bMobileTable?"items":"rows"):false;};X.prototype.bindRows=function(){if(!this.bDelegateInitialized||!this._oTable){return;}var l1={};this.getControlDelegate().updateBindingInfo(this,l1);if(l1.path){this._oTable.setShowOverlay(false);if(this._bMobileTable&&this._oTemplate){l1.template=this._oTemplate;}else{delete l1.template;}X._addBindingListener(l1,"dataRequested",this._onDataRequested.bind(this));X._addBindingListener(l1,"dataReceived",this._onDataReceived.bind(this));X._addBindingListener(l1,"change",this._onBindingChange.bind(this));this._updateColumnsBeforeBinding();this.getControlDelegate().updateBinding(this,l1,this._bForceRebind?null:this.getRowBinding());this._updateInnerTableNoDataText();this._bForceRebind=false;}};X.prototype._onDataRequested=function(){this._bIgnoreChange=true;};X.prototype._onDataReceived=function(){this._bIgnoreChange=false;this._updateHeaderText();this._updateExportState();};X.prototype._onBindingChange=function(){if(this._bIgnoreChange){return;}this._updateHeaderText();};X.prototype._updateHeaderText=function(){var l1,m1;if(!this._oNumberFormatInstance){this._oNumberFormatInstance=N.getFloatInstance();}if(this._oTitle&&this.getHeader()){l1=this.getHeader();if(this.getShowRowCount()){m1=this._getRowCount(true);if(m1>0){var n1=this._oNumberFormatInstance.format(m1);l1+=" ("+n1+")";}}this._oTitle.setText(l1);}if(!this._bIgnoreChange&&this._bAnnounceTableUpdate){this._bAnnounceTableUpdate=false;this._announceTableUpdate(m1);}};X.prototype._announceTableUpdate=function(l1){var m1=k.getInstance();if(m1){var n1=f.getLibraryResourceBundle("sap.ui.mdc");var o1=this.getHeader();if(l1===undefined&&this._getRowCount(false)>0){m1.announce(n1.getText("table.ANNOUNCEMENT_TABLE_UPDATED",[o1]));}else if(l1>1){m1.announce(n1.getText("table.ANNOUNCEMENT_TABLE_UPDATED_MULT",[o1,l1]));}else if(l1===1){m1.announce(n1.getText("table.ANNOUNCEMENT_TABLE_UPDATED_SING",[o1,l1]));}else{m1.announce(n1.getText("table.ANNOUNCEMENT_TABLE_UPDATED_NOITEMS",[o1]));}}};X.prototype._updateColumnsBeforeBinding=function(){var l1=this.getColumns();var m1=this.getPropertyHelper();l1.forEach(function(n1){var o1=n1.getInnerColumn();var p1=m1.getProperty(n1.getDataProperty());var q1=p1?p1.getSortableProperties().map(function(p1){return p1.name;}):[];var r1=this._getSortedProperties().find(function(r1){return q1.includes(r1.name);});var s1=r1&&r1.descending?H.Descending:H.Ascending;if(this._bMobileTable){o1.setSortIndicator(r1?s1:H.None);}else{o1.setSorted(!!r1).setSortOrder(s1);}},this);};X.prototype._getRowCount=function(l1){var m1=this._getRowBinding();if(!m1){return l1?undefined:0;}var n1;if(!l1){n1=m1.getLength();}else if(typeof m1.getCount==='function'){n1=m1.getCount();}else if(m1.isLengthFinal()){n1=m1.getLength();}if(n1<0||n1==="0"){n1=0;}return n1;};X.prototype.getRowBinding=function(){return this._getRowBinding();};X.prototype._getRowBinding=function(){if(this._oTable){return this._oTable.getBinding(this._sAggregation);}};X._addBindingListener=function(l1,m1,n1){if(!l1.events){l1.events={};}if(!l1.events[m1]){l1.events[m1]=n1;}else{var o1=l1.events[m1];l1.events[m1]=function(){n1.apply(this,arguments);o1.apply(this,arguments);};}};X.prototype._rebind=function(){if(this._bFullyInitialized){this.bindRows();}else{this._fullyInitialized().then(this._rebind.bind(this));}};function j1(l1){T.showPanel(this,"Columns",l1.getSource());}function k1(l1){T.showPanel(this,"Filter",l1.getSource());}X.prototype._getSorters=function(){var l1=this.getSortConditions()?this.getSortConditions().sorters:[];var m1=[],n1=this.getPropertyHelper();l1.forEach(function(o1){if(n1.hasProperty(o1.name)){var p1=n1.getProperty(o1.name).path;m1.push(new S(p1,o1.descending));}});return m1;};X.prototype._onInnerTablePaste=function(l1){if(!this.getEnablePaste()){return;}this.firePaste({data:l1.getParameter("data")});};X.prototype.exit=function(){if(this._oTemplate){this._oTemplate.destroy();}this._oTemplate=null;this._oTable=null;if(this._oToolbar&&!this._bTableExists){this._oToolbar.destroy();}this._oToolbar=null;this._oTitle=null;this._oNumberFormatInstance=null;Y.forEach(function(l1){var m1=h(l1),n1="_o"+m1;this[n1]=null;},this);this._oTableReady=null;this._oFullInitialize=null;this._oPasteButton=null;if(this._oFilterInfoBarInvisibleText){this._oFilterInfoBarInvisibleText.destroy();this._oFilterInfoBarInvisibleText=null;}C.prototype.exit.apply(this,arguments);};X.prototype.addAction=function(l1){if(l1.getMetadata().getName()!=="sap.ui.mdc.actiontoolbar.ActionToolbarAction"){l1=new t(l1.getId()+"-action",{action:l1});}return C.prototype.addAggregation.apply(this,["actions",l1]);};return X;});
