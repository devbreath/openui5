/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/flexState/ManifestUtils"],function(J,M){"use strict";function g(C){var o;var h=jQuery.find(".sapUiComponentContainer");h.some(function(i){var j=sap.ui.getCore().byId(i.id);var A=j&&j.getComponentInstance();if(A&&M.getFlexReferenceForControl(A)===C){o=A;return true;}});return o;}function e(C,E){var A=g(E.sComponentName);for(var s in C._mChangesEntries){var o=C._mChangesEntries[s];E.mChangesEntries[s]={mDefinition:o._oDefinition,aControlsDependencies:[],aDependencies:[]};if(o._aDependentSelectorList){o._aDependentSelectorList.forEach(function(S){var m={bPresent:!!J.bySelector(S,A),aAppliedChanges:[],aFailedChangesJs:[],aFailedChangesXml:[],aNotApplicableChanges:[]};E.mControlData[S.id]=m;});}}a(C,E);}function a(C,E){for(var s in C._mChangesInitial.mDependencies){var m=C._mChangesInitial.mDependencies[s];E.mChangesEntries[s].aControlsDependencies=m.controlsDependencies;E.mChangesEntries[s].aDependencies=m.dependencies;}}function b(C,E){jQuery.each(C._mVariantsChanges,function(s,o){E.mVariantsChanges[s]={mDefinition:o._oDefinition};});}function c(E,s,C,h,i){if(i){C[h]=i;C[h].map(function(j){if(!(j in E[s])){E[s].push(j);}});}}function d(C,i){var h=C.getCustomData();var j=[];h.forEach(function(o){var k=o.getKey();if(k.startsWith(i)){j.push(k.replace(i,""));}});return j;}function f(C,E){for(var s in C._mChanges.mChanges){var m={bPresent:false,aAppliedChanges:[],aFailedChangesJs:[],aFailedChangesXml:[],aNotApplicableChanges:[]};var o=sap.ui.getCore().byId(s);if(o){m.bPresent=true;c(E,"aAppliedChanges",m,"aAppliedChanges",d(o,"sap.ui.fl.appliedChanges."));c(E,"aFailedChanges",m,"aFailedChangesJs",d(o,"sap.ui.fl.failedChanges.js."));c(E,"aFailedChanges",m,"aFailedChangesXml",d(o,"sap.ui.fl.failedChanges.xml."));c(E,"aNotApplicableChanges",m,"aNotApplicableChanges",d(o,"sap.ui.fl.notApplicableChanges."));}E.mControlData[s]=m;}}return function(C){var E={sVersion:"1",bIsInvestigationExport:true,mControlData:{},aAppliedChanges:[],aFailedChanges:[],aNotApplicableChanges:[],mChangesEntries:{},mVariantsChanges:{},sComponentName:C._mComponent.name};e(C,E);b(C,E);f(C,E);return E;};});
