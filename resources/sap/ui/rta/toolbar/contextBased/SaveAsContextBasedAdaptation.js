/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","sap/ui/core/Fragment","sap/ui/fl/Layer","sap/ui/fl/write/api/ContextSharingAPI","sap/ui/rta/Utils","sap/ui/model/Binding"],function(t,e,o,n,a,i){"use strict";var s=t.extend("sap.ui.rta.toolbar.contextBased.SaveAsContextBasedAdaptation",{metadata:{properties:{toolbar:{type:"any"}}},constructor:function(){t.prototype.constructor.apply(this,arguments);this.oTextResources=this.getToolbar().getTextResources()}});s.prototype.openAddAdaptationDialog=function(t){if(!this._oAddAdaptationDialogPromise){this._oAddAdaptationDialogPromise=e.load({name:"sap.ui.rta.toolbar.contextBased.SaveAsContextBasedAdaptationDialog",id:this.getToolbar().getId()+"_fragment--sapUiRta_addAdaptationDialog",controller:{onAdaptationTitleChange:d.bind(this),onSaveAsContextBasedAdaptation:r.bind(this),onCancelContextBasedAdaptationDialog:l.bind(this)}}).then(function(e){this._oAddAdaptationDialog=e;e.addStyleClass(a.getRtaStyleClassName());this.getToolbar().addDependent(this._oAddAdaptationDialog);p.call(this,t)}.bind(this))}else{this.getToolbar().getControl("addAdaptationDialog--saveContextBasedAdaptation-title-input").setValue("")}return this._oAddAdaptationDialogPromise.then(function(){return this._oAddAdaptationDialog.open()}.bind(this))};function d(t){this.sAdaptationTitle=t.getParameter("value");c.call(this)}function l(){C.call(this);this._oAddAdaptationDialog.close()}function r(){var t={};t.title=h.call(this);t.contexts=this._oContextComponentInstance.getSelectedContexts();this.getToolbar().fireEvent("saveAsContextBasedAdaptation",t)}function p(t){var e={layer:t||o.CUSTOMER};return n.createComponent(e).then(function(t){this._oContextComponent=t;this._oContextComponentInstance=t.getComponentInstance();this._oContextComponentInstance.resetSelectedContexts();this._oAddAdaptationDialog.addContent(this._oContextComponent);var e=this._oContextComponentInstance.getSelectedContextsModel();this.oSelectedContextsBinding=new i(e,"/",e.getContext("/"));this.oSelectedContextsBinding.attachChange(c.bind(this))}.bind(this))}function h(){return this.sAdaptationTitle||""}function c(){var t=h.call(this).length>0&&this._oContextComponentInstance.getSelectedContexts().role.length>0;this.getToolbar().getControl("addAdaptationDialog--saveContextBasedAdaptation-saveButton").setEnabled(t)}function C(){if(this._oContextComponentInstance){if(this._oContextComponent.isDestroyed()){return p.call(this)}this._oContextComponentInstance.resetSelectedContexts();this._oAddAdaptationDialog.addContent(this._oContextComponent)}}return s});
//# sourceMappingURL=SaveAsContextBasedAdaptation.js.map