/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Fragment","sap/ui/fl/write/api/Version","sap/ui/rta/toolbar/translation/Translation","sap/ui/rta/toolbar/versioning/Versioning","sap/ui/rta/appVariant/Feature","sap/ui/rta/toolbar/Base","sap/ui/Device","./AdaptationRenderer"],function(F,V,T,a,A,B,D,b){"use strict";var c=B.extend("sap.ui.rta.toolbar.Adaptation",{renderer:b,animation:true,metadata:{library:"sap.ui.rta",events:{undo:{},redo:{},exit:{},save:{},restore:{},transport:{},publishVersion:{},modeChange:{},activate:{},discardDraft:{},switchVersion:{},openChangeCategorySelectionPopover:{}}}});c.modes={MOBILE:"sapUiRtaToolbarMobile",TABLET:"sapUiRtaToolbarTablet",DESKTOP:"sapUiRtaToolbarDesktop"};var d="sapUiRtaToolbar";c.prototype.init=function(){this._pFragmentLoaded=B.prototype.init.apply(this,arguments).then(function(){if(!D.media.hasRangeSet(d)){D.media.initRangeSet(d,[900,1200],"px",[c.modes.MOBILE,c.modes.TABLET,c.modes.DESKTOP]);}D.media.attachHandler(this._onSizeChanged,this,d);}.bind(this));};c.prototype.onFragmentLoaded=function(){return this._pFragmentLoaded;};c.prototype.exit=function(){D.media.detachHandler(this._onSizeChanged,this,d);B.prototype.exit.apply(this,arguments);};c.prototype.show=function(){this._onSizeChanged(D.media.getCurrentRange(d),true);return B.prototype.show.apply(this,arguments);};function s(j,I,t,k){var l=this.getControl(j);var m=t?this.getTextResources().getText(t):"";var n=k?this.getTextResources().getText(k):"";l.setText(m||"");l.setTooltip(n||"");l.setIcon(I||"");}c.prototype.formatPublishVersionVisibility=function(p,v,j,m){return this.getExtension("versioning",a).formatPublishVersionVisibility(p,v,j,m);};c.prototype.formatDiscardDraftVisible=function(j,v,m){return this.getExtension("versioning",a).formatDiscardDraftVisible(j,v,m);};c.prototype.formatVersionButtonText=function(v,j){return this.getExtension("versioning",a).formatVersionButtonText(v,j);};c.prototype.showVersionHistory=function(E){return this.getExtension("versioning",a).showVersionHistory(E);};c.prototype._openVersionTitleDialog=function(j){return this.getExtension("versioning",a).openActivateVersionDialog(j);};c.prototype.showRestore=function(v){return!v;};c.prototype._showButtonIcon=function(j,I,t){s.call(this,j,I,"",t);};c.prototype._showButtonText=function(j,t){s.call(this,j,"",t,"");};c.prototype._switchToIcons=function(){var I=this.getControl("iconBox");var j=this.getControl("iconSpacer");I.setVisible(false);j.setVisible(false);this._showButtonIcon("adaptationSwitcherButton","sap-icon://wrench","BTN_ADAPTATION");this._showButtonIcon("navigationSwitcherButton","sap-icon://explorer","BTN_NAVIGATION");this._showButtonIcon("visualizationSwitcherButton","sap-icon://show","BTN_VISUALIZATION");this._showButtonIcon("exit","sap-icon://decline","BTN_EXIT");};c.prototype._switchToTexts=function(){var I=this.getControl("iconBox");var j=this.getControl("iconSpacer");I.setVisible(true);j.setVisible(true);this._showButtonText("adaptationSwitcherButton","BTN_ADAPTATION");this._showButtonText("navigationSwitcherButton","BTN_NAVIGATION");this._showButtonText("visualizationSwitcherButton","BTN_VISUALIZATION");this._showButtonText("exit","BTN_EXIT");};c.prototype._onSizeChanged=function(p,I){if(p){var m=p.name;this.sMode=m;switch(m){case c.modes.MOBILE:this._switchToIcons();break;case c.modes.TABLET:case c.modes.DESKTOP:if(!I){this._switchToTexts();}break;default:}}};c.prototype.buildControls=function(){return F.load({name:"sap.ui.rta.toolbar.Adaptation",id:this.getId()+"_fragment",controller:{activate:this._openVersionTitleDialog.bind(this),discardDraft:this.eventHandler.bind(this,"DiscardDraft"),formatDiscardDraftVisible:this.formatDiscardDraftVisible.bind(this),formatPublishVersionVisibility:this.formatPublishVersionVisibility.bind(this),modeChange:this.eventHandler.bind(this,"ModeChange"),openDownloadTranslationDialog:o.bind(this),openUploadTranslationDialog:e.bind(this),undo:this.eventHandler.bind(this,"Undo"),redo:this.eventHandler.bind(this,"Redo"),openChangeCategorySelectionPopover:this.eventHandler.bind(this,"OpenChangeCategorySelectionPopover"),manageApps:i.bind(this),appVariantOverview:h.bind(this),saveAs:g.bind(this),formatSaveAsEnabled:f,restore:this.eventHandler.bind(this,"Restore"),publish:this.eventHandler.bind(this,"Transport"),publishVersion:this.eventHandler.bind(this,"PublishVersion"),exit:this.eventHandler.bind(this,"Exit"),formatVersionButtonText:this.formatVersionButtonText.bind(this),showVersionHistory:this.showVersionHistory.bind(this),showRestore:this.showRestore.bind(this)}});};function o(){var p={layer:this.getRtaInformation().flexSettings.layer,selector:this.getRtaInformation().rootControl};this.getExtension("translation",T).openDownloadTranslationDialog(p);}function e(){this.getExtension("translation",T).openUploadTranslationDialog();}function f(G,j){return G&&j!==V.Number.Draft;}function g(){A.onSaveAs(true,true,this.getRtaInformation().flexSettings.layer,null);}function h(E){var I=E.getParameter("item");var t=I.getId().endsWith("keyUser");return A.onGetOverview(t,this.getRtaInformation().flexSettings.layer);}function i(){A.onGetOverview(true,this.getRtaInformation().flexSettings.layer);}c.prototype.getControl=function(n){return sap.ui.getCore().byId(this.getId()+"_fragment--sapUiRta_"+n);};return c;});
