/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseFilter","sap/ui/core/library","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/ui/integration/util/BindingResolver"],function(B,c,D,a,b){"use strict";var V=c.ValueState;var M=new Date(-8640000000000000);var d=new Date("1753-01-01");var e=new Date(8640000000000000);var f=new Date("9999-12-31");var o={"DATE":"date","TODAY":"today","YESTERDAY":"yesterday","TOMORROW":"tomorrow","DATERANGE":"dateRange","FROM":"from","TO":"to","YEARTODATE":"yearToDate","LASTDAYS":"lastDays","LASTWEEKS":"lastWeeks","LASTMONTHS":"lastMonths","LASTQUARTERS":"lastQuarters","LASTYEARS":"lastYears","NEXTDAYS":"nextDays","NEXTWEEKS":"nextWeeks","NEXTMONTHS":"nextMonths","NEXTQUARTERS":"nextQuarters","NEXTYEARS":"nextYears","TODAYFROMTO":"todayFromTo","THISWEEK":"thisWeek","LASTWEEK":"lastWeek","NEXTWEEK":"nextWeek","SPECIFICMONTH":"specificMonth","THISMONTH":"thisMonth","LASTMONTH":"lastMonth","NEXTMONTH":"nextMonth","THISQUARTER":"thisQuarter","LASTQUARTER":"lastQuarter","NEXTQUARTER":"nextQuarter","QUARTER1":"quarter1","QUARTER2":"quarter2","QUARTER3":"quarter3","QUARTER4":"quarter4","THISYEAR":"thisYear","LASTYEAR":"lastYear","NEXTYEAR":"nextYear"};function g(O){return o[O];}var h=B.extend("sap.ui.integration.cards.filters.DateRangeFilter",{metadata:{library:"sap.ui.integration",aggregations:{_ddr:{type:"sap.m.DynamicDateRange",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2}});h.prototype.getField=function(){return this._getDdr();};h.prototype.getValueForModel=function(){var i=this._getDdr().getValue();var v;var r;var R;if(i){v={option:g(i.operator),values:i.values.slice()};var j=a.toDates(i),s=j[0].getJSDate?j[0].getJSDate():j[0],S=i.operator==="TO"||i.operator==="FROM"?0:1,E=j[S]&&j[S].getJSDate?j[S].getJSDate():j[S];r={start:s.toISOString(),end:E.toISOString()};R={start:s.toISOString(),end:E.toISOString()};if(i.operator==="TO"){r.start=M.toISOString();R.start=d.toISOString();}if(i.operator==="FROM"){r.end=e.toISOString();R.end=f.toISOString();}}return{value:v,range:r,rangeOData:R};};h.prototype._getDdr=function(){var C=this.getAggregation("_ddr");if(!C){C=this._createDdr();this.setAggregation("_ddr",C);}return C;};h.prototype._createDdr=function(){var C=Object.assign({},this.getConfig());var v;if(C.value){C.value=b.resolveValue(C.value,this.getCardInstance());var O=C.value.option.toUpperCase();var t=a.getOption(O).getValueTypes();v={operator:O,values:C.value.values.map(function(k,i){if(t[i]==="date"){return new Date(k);}return k;})};}C.options=C.options||this._getDefaultOptions();C.options=C.options.map(function(O){return O.toUpperCase();});var j=new D({value:v,options:C.options}).addStyleClass("sapFCardDateRangeField");j.attachChange(function(E){if(E.getParameter("valid")){j.setValueState(V.None);this._setValue();}else{j.setValueState(V.Error);}}.bind(this));var l=this.createLabel(C);if(l){j.addAriaLabelledBy(l);}return j;};h.prototype._getDefaultOptions=function(){return["date","today","dateRange","from","to","lastDays","nextDays","lastWeeks","nextWeeks"];};h.prototype.getOptions=function(){return o;};return h;});
