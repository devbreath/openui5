/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseAction","sap/base/Log","sap/ui/integration/util/BindingHelper","sap/ui/integration/util/BindingResolver","sap/ui/integration/util/Utils"],function(B,L,a,b,U){"use strict";var S=B.extend("sap.ui.integration.cards.actions.SubmitAction",{metadata:{library:"sap.ui.integration"}});S.prototype.execute=function(){var c=this.getCardInstance(),s=this.getActionHandler();if(!s){return;}var d=this.getCardInstance()._oDataProviderFactory,D=c.getModel("form").getData();this._onActionSubmitStart(D);var o=d.create({request:this._createRequest(s,D)});o.getData().then(function(r){this._onActionSubmitEnd(r,null);}.bind(this),function(e){L.error(e);this._onActionSubmitEnd(null,{error:e});}.bind(this)).finally(function(){d.remove(o);});};S.prototype._onActionSubmitStart=function(d){var s=this.getSourceInstance();if(s.isA("sap.ui.integration.cards.BaseContent")){s.onActionSubmitStart(d);}};S.prototype._onActionSubmitEnd=function(r,e){var s=this.getSourceInstance();if(s.isA("sap.ui.integration.cards.BaseContent")){s.onActionSubmitEnd(r,e);}};S.prototype._createRequest=function(s,d){return{mode:s.mode||"cors",url:s.url,method:s.method||"POST",parameters:this._resolveActionHandlerParams(s.parameters)||d,headers:s.headers,xhrFields:{withCredentials:!!s.withCredentials}};};S.prototype._resolveActionHandlerParams=function(A){var c=this.getCardInstance();A=b.resolveValue(a.createBindingInfos(A,c.getBindingNamespaces()),this.getSourceInstance());U.makeUndefinedValuesNull(A);return A;};return S;});
