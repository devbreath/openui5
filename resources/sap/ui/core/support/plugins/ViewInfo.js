/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/core/support/Plugin','sap/ui/core/support/controls/TreeViewer','sap/ui/core/support/controls/ObjectViewer','sap/ui/Device','sap/base/Log','sap/ui/thirdparty/jquery'],function(P,T,O,D,L,$){"use strict";var V=P.extend("sap.ui.core.support.plugins.ViewInfo",{constructor:function(s){P.apply(this,["sapUiSupportViewInfo","XML View and Templating Support Tools",s]);this._oStub=s;}});V.prototype.init=function(s){P.prototype.init.apply(this,arguments);if(!this.runsAsToolPlugin()){return;}if(!D.browser.chrome){this.$().get(0).innerHTML="View Info Support Tool is currently only available on Chrome. We are currently working to support all browsers.";return;}try{this.supportInfo=window.opener.sap.ui.core.support.Support.info;}catch(e){this.$().get(0).innerHTML="View Info Support Tool needs access to the opener window. The opener window might not be accessible due to cross domain restrictions.";return;}if(typeof this.supportInfo!=="function"){this.$().get(0).innerHTML="<div class='sapUISupportLabel'>"+"View Info Support Tool is only available in <b>Support Mode.</b>"+"<br>Turn it on by adding '<b>sap-ui-support=true</b>' to the URL of your application."+"</div>";return;}try{this.aViews=this.supportInfo.getAll("view");this.aOdataModels=this.supportInfo.getAll("datajs");}catch(e){this.$().get(0).innerHTML="View Info Support Tool raised an internal error while reading the support informations.";return;}if(!this.aViews){this.$().get(0).innerHTML="View Info Support Tool did not record any information on the current page.<br>"+"Possible reasons:<br>"+"There are no XML Views defined in the current app.<br>"+"Views where not loaded before the Diagnostics tool was started.";}if(this.runsAsToolPlugin()){a.call(this,s);}};function a(s){$(document).on("click",".viewxmlheader",$.proxy(this._onToggleViewInfo,this)).on("click",".viewxmlmain",$.proxy(this._onMainViewInfo,this));this.renderContentAreas();}V.prototype.exit=function(s){P.prototype.exit.apply(this,arguments);if(this.runsAsToolPlugin()){$(document).off("click",".viewxmlheader",$.proxy(this._onToggleViewInfo,this)).off("click",".viewxmlmain",$.proxy(this._onMainViewInfo,this));}};V.prototype.provideNodeInfo=function(v,n,A){if(v.env.type!=="template"){var d=this.getObjectInfo(n);var i=[];if(d){var I=this.getBreakpointInfos(d);if(I.Template){i.push(I.Template);}if(I.Attributes){i.push(I.Attributes);}if(I.Properties){i.push(I.Properties);}if(I.Methods){i.push(I.Methods);}}return i;}};V.prototype.highlightTemplateTreeNode=function(t,d,i){t.clearHighlights();var I=this.getSupportInfos(d);for(var i=0;i<I.length;i++){if(I[i].context){t.expandNode(I[i].context);t.highlightNode(I[i].context);}}};V.prototype.createTree=function(v,i){var t=new T(),b=this,r=v.context;t.viewDebugInfo=v;if(v.env.type==="template"){t.ignoreIds();r=v.env.clone;}var n=r.querySelectorAll("*");for(var j=0;j<n.length;j++){var N=n[j],I=N.getAttribute("support:data"),c=this.supportInfo.getIds(I);if(c.length>0){if(!N.getAttribute("id")){N.setAttribute("id","");}N.setAttribute("__id",c[0]);}else{N.setAttribute("__id",N.getAttribute("id"));}}t.setRootObject(r);t.attachSelectionChange((function(i){return function(d,R){if(v){if(v.env.type!=="template"){b.updateObjectInfo(d,i,R);if(v.env.templateTree){b.highlightTemplateTreeNode(v.env.templateTree,d,i);}}}};})(i));t.attachAttributeInfos(function(N,A){if(v){if(v.env.type!=="template"){if(A.name.indexOf("support:")>-1){return{visible:false};}if(A.name.indexOf("xmlns:support")>-1){return{visible:false};}}}});t.attachNodeInfos(function(N,A){return b.provideNodeInfo(v,N,A);});return t;};V.prototype.renderContentAreas=function(){this._propertyChangeDebugger={};this._methodDebugger={};var r=sap.ui.getCore().createRenderManager();if(!this.aTrees){this.aTrees=[];this.aDataTrees=[];this.aObjectViewers=[];var i=0;r.openStart("div").class("viewxmlmain").openEnd();r.openStart("div").class("settingscontainer").openEnd();r.openStart("span").class("settings").attr("raise","_onClearAllBreakpoints").openEnd().text("Clear all breakpoints").close("span");r.openStart("span").class("settings").attr("raise","_onClearAllXMLModifications").openEnd().text("Clear all XML modifications").close("span");r.close("div");this.aMetamodels=[];if(this.aOdataModels){for(var j=0;j<this.aOdataModels.length;j++){var m=this.aOdataModels[j];if(m&&m.env.type==="metadata"){this.aMetamodels.push(m);var t=this.createTree(m,i);this.aTrees[i]=t;r.openStart("div").class("viewxmlheader").attr("collapsed","true").openEnd();r.openStart("span").class("toggle").openEnd().close("span");r.openStart("span").class("info").openEnd().text("Metadata: "+m.env.settings.response.requestUri).close("span");r.openStart("div").class("settingscontainer").openEnd();r.openStart("span").class("settings").class("sapUiSupportViewInfoElementHidden").attr("raise","_onToggleDebugNodes").attr("idx",i).openEnd().text("Expand debugged nodes").close("span");r.openStart("span").class("settings").class("sapUiSupportViewInfoElementHidden").attr("raise","_onToggleRealIds").attr("idx",i).openEnd();r.openStart("span").attr("selected","false").openEnd().close("span");r.text("Show XML View Ids");r.close("span");r.openStart("span").class("settings").attr("raise","_onToggleNamespace").attr("idx",i).openEnd();r.openStart("span").attr("selected","false").openEnd().close("span");r.text("Hide tag namespace");r.close("span");r.openStart("span").class("settings").attr("raise","_onToggleInactive").attr("idx",i).openEnd();r.openStart("span").attr("selected","false").openEnd().close("span");r.text("Hide inactive");r.close("span");r.close("div");r.close("div");r.openStart("div").class("sapUiSupportViewInfoElementHidden").openEnd();r.openStart("div","treecontent_"+i).openEnd().close("div");r.openStart("div").class("viewxmlsplitter").openEnd().close("div");r.openStart("div").class("viewxmlinfo").openEnd();r.openStart("div","objectHeader"+i).class("title").class("sapUiSupportViewInfoElementHidden").openEnd().text("Header").close("div");r.openStart("div","objectToolbar"+i).class("toolbar").class("sapUiSupportViewInfoElementHidden").openEnd().text("Toolbar").close("div");r.openStart("div","selectedcontent_"+i).class("content").openEnd().close("div");r.close("div");r.close("div");}m.env.tree=t;i++;}}if(this.aViews){for(var j=0;j<this.aViews.length;j++){var v=this.aViews[j];var t=this.createTree(v,i);this.aTrees[i]=t;this.aObjectViewers[i]=null;var I="";if(v.env.type=="template"){I=v.env.viewinfo.id;}else{I=v.env.viewinfo.getId();for(var k=0;k<this.aTrees.length;k++){if(this.aTrees[k]&&this.aTrees[k].viewDebugInfo.env.type==="template"&&this.aTrees[k].viewDebugInfo.env.viewinfo.id===I){v.env.templateTree=this.aTrees[k];}}if(v.env.settings.preprocessors&&v.env.settings.preprocessors.xml&&v.env.settings.preprocessors.xml.models){var M=v.env.settings.preprocessors.xml.models;if(M){for(var n in M){if(M[n].oMetadata){var u=M[n].oMetadata.sUrl;for(var k=0;k<this.aMetamodels.length;k++){var o=this.aMetamodels[k];if(o&&o.env.settings.response.requestUri===u){if(!v.env.metamodels){v.env.metamodels=[];}v.env.metamodels.push({tree:o.env.tree,model:o,data:M[n],metamodel:M[n].oMetaModel,metadata:M[n].oMetadata});}}}}}}}if(v.env.type==="template"){r.openStart("div").class("viewxmlheader").attr("collapsed","true").openEnd();r.openstart("span").class("toggle").openEnd().close("span");r.openStart("span").class("info").openEnd().text(I+' ('+v.env.type+')').close("span");r.openStart("div").class("settingscontainer").openEnd();r.openStart("span").class("settings").attr("raise","_onToggleDebugNodes").attr("idx",i).openEnd().text("Expand debugged nodes").close("span");r.openStart("span").class("settings").class("sapUiSupportViewInfoElementHidden").attr("raise","_onToggleRealIds").attr("idx",i).openEnd();r.openStart("span").attr("selected","false").openEnd().close("span");r.text("Show XML View Ids");r.close("span");r.openStart("span").class("settings").attr("raise","_onToggleNamespace").attr("idx",i).openEnd();r.openStart("span").attr("selected","false").openEnd().close("span");r.text("Hide tag namespace");r.close("span");r.openStart("span").class("settings").attr("raise","_onToggleInactive").attr("idx",i).openEnd();r.openStart("span").attr("selected","false").openEnd().close("span");r.text("Hide inactive");r.close("span");r.close("div");r.close("div");}else{var s="";if(v.env.metamodels){s=":templated by [";for(var x=0;x<v.env.metamodels.length;x++){s+=v.env.metamodels[x].metadata.sUrl;}s+="]";}var c="";if(v.env.settings.cache){c+=" from client cache "+JSON.stringify(v.env.settings.cache);}r.openStart("div").class("viewxmlheader").attr("collapsed","true").openEnd();r.openStart("span").class("toggle").openEnd().close("span");r.openStart("span").class("info").openEnd().text(I+' ('+v.env.type+s+') '+c).close("span");r.openStart("div").class("settingscontainer").openEnd();r.openStart("span").class("settings").attr("raise","_onToggleDebugNodes").attr("idx",i).openEnd().text("Expand debugged nodes").close("span");r.openStart("span").class("settings").attr("raise","_onToggleRealIds").attr("idx",i).openEnd();r.openStart("span").attr("selected","false").openEnd().close("span");r.text("Show XML View Ids");r.close("span");r.openStart("span").class("settings").attr("raise","_onToggleNamespace").attr("idx",i).openEnd();r.openStart("span").attr("selected","false").openEnd().close("span");r.text("Hide tag namespace");r.close("span");r.close("div");r.close("div");}r.openStart("div").class("sapUiSupportViewInfoElementHidden").openEnd();r.openStart("div","treecontent_"+i).openEnd().close("div");r.openStart("div").class("viewxmlsplitter").openEnd().close("div");r.openStart("div").class("viewxmlinfo").openEnd();r.openStart("div","objectHeader"+i).class("title").class("sapUiSupportViewInfoElementHidden").openEnd().text("Header").close("div");r.openStart("div","objectToolbar"+i).class("toolbar").class("sapUiSupportViewInfoElementHidden").openEnd().text("Toolbar").close("div");r.openStart("div","selectedcontent_"+i).class("content").openEnd().close("div");r.close("div");r.close("div");r.close("div");i++;}}}r.flush(this.$().get(0));if(this.aTrees){for(var i=0;i<this.aTrees.length;i++){var t=this.aTrees[i];var d=document.getElementById("treecontent_"+i);if(d){t.update(d);}}}r.destroy();};V.prototype._onClearAllBreakpoints=function(){this.supportInfo.removeAllBreakpoints();};V.prototype._onClearAllXMLModifications=function(){this.supportInfo.removeAllXMLModification();};V.prototype.getBreakpointInfos=function(d){var I={},i;function c(d){var b=0;for(var n in d){if(d[n].__enabled){b++;}}return b;}if(d.Template){i=c(d.Template);I["Template"]={selected:i>0,color:"orange",tooltip:"Template Breakpoints ("+i+")"};}if(d.Attributes){i=c(d.Attributes);I["Attributes"]={selected:i>0,color:"blue",tooltip:"Attribute Changes ("+i+")"};}if(d.Properties){i=c(d.Properties);I["Properties"]={selected:i>0,color:"green",tooltip:"Property Change Breakpoints ("+i+")"};}if(d.Methods){i=c(d.Methods);I["Methods"]={selected:i>0,color:"red",tooltip:"Method Breakpoints ("+i+")"};}return I;};V.prototype.getSupportInfos=function(n){var i=n.getAttribute("support:data");return this.supportInfo.getInfos(i);};V.prototype.parseScalarType=function(t,v,n,c){var b=window.opener.sap.ui.base.DataType;var M=window.opener.sap.ui.base.ManagedObject;try{var B=M.bindingParser(v,c,true);if(B&&typeof B==="object"){return{binding:B};}}catch(e){return{error:"Property "+n+" - Invalid Binding:"+e.message};}var d=v=typeof B==="string"?B:v;var o=b.getType(t);if(o){if(o instanceof b){d=o.parseValue(v);}}else{return{error:"Property "+n+" has unknown type "+t};}if(!o.isValid(d)){return{error:"Property "+n+" has invalid value;"};}return{value:d};};V.prototype.getObjectInfo=function(n,I){var t=this;function c(j,e,n){return function(v){var l=t.parseScalarType(j.type,v,j.name,null);for(var i=0;i<e.length;i++){e[i].isBound(j.name);if(j.bindable){e[i][j._sUnbind](l.binding);}else{e[i].unbindProperty(j.name);}if(l.binding){if(j.bindable){e[i][j._sBind](l.binding);}else{e[i].bindProperty(j.name,l.binding);}}else if(l.value!==undefined){e[i][j._sMutator](l.value);}}n.setAttribute("__changed"+j.name,v);return l;};}function C(j,n,d){return function(v){var l=t.parseScalarType(j.type,v,j.name,null);for(var i=0;i<e.length;i++){e[i].isBound(j.name);if(j.bindable){e[i][j._sUnbind](l.binding);}else{e[i].unbindProperty(j.name);}if(l.binding){if(j.bindable){e[i][j._sBind](l.binding);}else{e[i].bindProperty(j.name,l.binding);}}else if(l.value!==undefined){e[i][j._sMutator](l.value);}}if(!l.error){n.getAttribute("_index");var q=n.parentNode,r=null;while(q){r=q;q=q.parentNode;}if(r){var u=r.querySelectorAll("*");for(var i=0;i<u.length;i++){if(u[i]===n){t.supportInfo.addXMLModification(I,i+1,{setAttribute:[j.name,v]});return;}}}}return l;};}var N=n.namespaceURI,s=n.localName,d={};var o=window.opener.jQuery.sap.getObject(N+"."+s);if(o){var b=n.getAttribute("support:data");var A=o.getMetadata().getAllProperties(),m=o.prototype,e=this.supportInfo.getElements(b),f=this.getValidDebugStackIndices(n);if(e.length>0){d.Control={};d.Control[e[0].getMetadata().getName()]={value:e[0].getId(),__highlightid:true,__readonly:true};if(e.length>1){d.Clones={};for(var i=1;i<e.length;i++){d.Clones[e[i].getMetadata().getName()+"("+i+")"]={value:e[i].getId(),__highlightid:true};}}}if(f.length>0){d.Template={};for(var i=0;i<f.length;i++){var g=f[i];d.Template[g.__infokey]={value:g.__infovalue,__idx:f[i]._idx,__enabled:this.supportInfo.hasBreakpointAt(f[i]._idx),__level:g.__level};}}var p=Object.keys(A).sort();if(n.attributes.length>0){d.Attributes={};for(var i=0;i<n.attributes.length;i++){var h=n.attributes[i];if(p.indexOf(h.name)>-1){var j=A[p[p.indexOf(h.name)]];d.Attributes[h.name]={value:h.value,__enabled:false,__docu:V.DemokitUrl+j._oParent.getName()+"#"+j._sGetter,__original:h.value,__change:C(j,n,I),__add:true};}}}if(p.length>0){d.Properties={};for(var i=0;i<p.length;i++){var j=A[p[i]];var k={value:n.getAttribute("__changed"+j.name)||n.getAttribute(p[i]),value2:e[0]&&e[0][j._sGetter]?e[0]&&e[0][j._sGetter]():null,__controls:e,__enabled:e[0]&&this._propertyChangeDebugger[e[0].getId()+"__"+p[i]]!=null,__docu:V.DemokitUrl+j._oParent.getName()+"#"+j._sGetter,__original:n.getAttribute(p[i]),__changed:null};k.__change=c(j,e,n);d.Properties[p[i]]=k;}}var M=Object.keys(m).sort();if(M.length>0){d.Methods={};for(var i=0;i<M.length;i++){d.Methods[M[i]]={value:"",__controls:e,__enabled:e[0]&&this._methodDebugger[e[0].getId()+"__"+M[i]]!=null};}}}return d;};V.prototype._makePropFn=function(k){return function(e){if(e.getParameter("name")===k){debugger;}};};V.prototype._makeFn=function(f){return function(){debugger;return f.apply(this,arguments);};};V.prototype.highlightControl=function(d,s,o){try{if(this._highlightControl){this._highlightControl.control.getDomRef().style.outline=this._highlightControl.outline;}if(this._highlightControls){for(var i=0;i<this._highlightControls.length;i++){this._highlightControls[i].control.getDomRef().style.outline=this._highlightControls[i].outline;}}this._highlightControl=null;this._highlightControls=[];if(d.Control&&d.Control[Object.keys(d.Control)[0]].__highlightid){if(s==="Control"&&d.Clones){for(var n in d.Clones){var c=opener.sap.ui.getCore().byId(d.Clones[n].value);if(c&&c.getDomRef()){this._highlightControls.push({control:c,outline:c.getDomRef().style.outline});c.getDomRef().style.outline="solid 1px orange";}}}else{if(!o){o=d.Control[Object.keys(d.Control)[0]];}if(s==="Control"&&o){var C=opener.sap.ui.getCore().byId(o.value);if(C&&C.getDomRef()){this._highlightControl={control:C,outline:C.getDomRef().style.outline};if(C.getDomRef()){C.getDomRef().style.outline="solid 1px orange";}}}}if(s==="Clones"){var C=opener.sap.ui.getCore().byId(o.value);if(C&&C.getDomRef()){this._highlightControl={control:C,outline:C.getDomRef().style.outline};if(C.getDomRef()){C.getDomRef().style.outline="solid 1px orange";}}}}}catch(e){L.debug("Diagnostics: ViewInfo failed to remove highlighting of controls");}};V.DemokitUrl="https://openui5.hana.ondemand.com/api/";V.prototype.updateObjectInfo=function(d,I,r){var o=this.aObjectViewers[I],t=this;if(!o){o=new O();this.aObjectViewers[I]=o;}var h=document.getElementById("objectHeader"+I);h.style.display="none";var b=this.aTrees[I];o.initialExpandedSections=this.oObjectViewer?this.oObjectViewer.expandedSections:[];var c=this.getObjectInfo(d,b.viewDebugInfo.env.viewinfo.getId());var H="";try{if(!c.Control&&d.parentNode){var C=d.parentNode.namespaceURI+"."+d.parentNode.localName;var A="get"+d.localName.substring(0,1).toUpperCase()+d.localName.substring(1);H+="<a target=\"_docu\" href=\""+V.DemokitUrl+C+"\">"+C+"</a> ("+d.tagName+") ";H+=": <a target=\"_docu\" href=\""+V.DemokitUrl+C+"#"+A+"\">"+d.localName+" aggregation</a>";}else{var C=d.namespaceURI+"."+d.localName;H+="<a target=\"_docu\" href=\""+V.DemokitUrl+C+"\">"+C+"</a> ("+d.tagName+") ";var p=window.opener.jQuery.sap.getObject(Object.keys(c.Control)[0]).getMetadata().getParent().getName();H+=": <a target=\"_docu\" href=\""+V.DemokitUrl+p+"\">"+p+"</a>";}}catch(e){H+="";}h.style.display="block";h.innerHTML=H;t.highlightControl(c,"Control");o.setRootObject(c);o.attachObjectInfos(function(s,S,g,k){if(S==="Template"){if(c[S][k].__enabled){return[{selected:true,color:"orange",tooltip:"Disable breakpoint"}];}else{return[{selected:false,color:"orange",tooltip:"Break if resolved after reload/reprocess"}];}}else if(S==="Attributes"){if(c[S][k].__enabled){return[{selected:true,color:"blue",tooltip:"Disable breakpoint"}];}else{return[{selected:false,color:"blue",tooltip:"Break if changed"}];}}else if(S==="Properties"){if(c[S][k].__enabled){return[{selected:true,color:"green",tooltip:"Disable breakpoint"}];}else{return[{selected:false,color:"green",tooltip:"Break if changed"}];}}else if(S==="Methods"){if(c[S][k].__enabled){return[{selected:true,color:"red",tooltip:"Disable breakpoint"}];}else{return[{selected:false,color:"red",tooltip:"Break if called"}];}}return[];});o.attachSelect(function(g){if(g&&g.__docu){window.open(g.__docu,"_docu");}});o.attachHover(function(g,s,k){t.highlightControl(c,s,g);});o.attachInfoPress(function(s,k,g){var I=c[s][k].__idx,E=c[s][k].__enabled;if(!E){if(s==="Template"){t.supportInfo.addBreakpointAt(I);}else if(s==="Properties"){var j=c[s][k].__controls;if(j){for(var i=0;i<j.length;i++){var l=j[i];t._propertyChangeDebugger[l.getId()+"__"+k]=t.supportInfo._breakAtProperty(k);l.attachEvent("_change",t._propertyChangeDebugger[l.getId()+"__"+k]);}}}else if(s==="Methods"){var j=c[s][k].__controls;if(j){for(var i=0;i<j.length;i++){var l=j[i];var m=l[k];t._methodDebugger[l.getId()+"__"+k+"__fn"]=m;t._methodDebugger[l.getId()+"__"+k]=t.supportInfo._breakAtMethod(m);l[k]=t._methodDebugger[l.getId()+"__"+k];}}}c[s][k].__enabled=true;o.setInfoSelected(s,k,g,true);}else{if(s==="Template"){t.supportInfo.removeBreakpointAt(I);}else if(s==="Properties"){var j=c[s][k].__controls;if(j){for(var i=0;i<j.length;i++){var l=j[i];l.detachEvent("_change",t._propertyChangeDebugger[l.getId()+"__"+k]);delete t._propertyChangeDebugger[l.getId()+"__"+k];}}}else if(s==="Methods"){var j=c[s][k].__controls;if(j){for(var i=0;i<j.length;i++){var l=j[i];l[k]=t._methodDebugger[l.getId()+"__"+k+"__fn"];delete t._methodDebugger[l.getId()+"__"+k];delete t._methodDebugger[l.getId()+"__"+k+"__fn"];}}}c[s][k].__enabled=false;o.setInfoSelected(s,k,g,false);}if(c){var n=t.getBreakpointInfos(c);var i=0;if(n.Template){b.setInfoSelected(b.getSelectedIndex(),i++,n.Template.selected,n.Template.tooltip);}if(n.Attributes){b.setInfoSelected(b.getSelectedIndex(),i++,n.Attributes.selected,n.Attributes.tooltip);}if(n.Properties){b.setInfoSelected(b.getSelectedIndex(),i++,n.Properties.selected,n.Properties.tooltip);}if(n.Methods){b.setInfoSelected(b.getSelectedIndex(),i,n.Methods.selected,n.Methods.tooltip);}}});var f=document.getElementById("selectedcontent_"+I);if(f){o.update(f);}this.oObjectViewer=o;};V.prototype._onToggleRealIds=function(e){var d=e.target;if(d.getAttribute("selected")){d=d.parentNode;}var i=parseInt(d.getAttribute("idx")),t=this.aTrees[i];if(t.toggleIds()){d.innerHTML="<span selected=\"false\"></span>Show XML View Ids";}else{d.innerHTML="<span selected=\"true\"></span>Show Real Ids";}};V.prototype._onToggleInactive=function(e){var d=e.target;if(d.getAttribute("selected")){d=d.parentNode;}var i=parseInt(d.getAttribute("idx")),t=this.aTrees[i];if(t.toggleInactive()){d.innerHTML="<span selected=\"false\"></span>Hide inactive";}else{d.innerHTML="<span selected=\"true\"></span>Show inactive";}e.stopPropagation();};V.prototype._onToggleNamespace=function(e){var d=e.target;if(d.getAttribute("selected")){d=d.parentNode;}var i=parseInt(d.getAttribute("idx")),t=this.aTrees[i];if(t.toggleNS()){d.innerHTML="<span selected=\"false\"></span>Hide tag namespace";}else{d.innerHTML="<span selected=\"true\"></span>Show tag namespace";}e.stopPropagation();};V.prototype._onToggleDebugNodes=function(e){var i=parseInt(e.target.getAttribute("idx")),t=this.aTrees[i];t.expandNodesWithSelectedInfo(0);t.expandNodesWithSelectedInfo(1);t.expandNodesWithSelectedInfo(2);};V.prototype.resizeHandler=function(){var v=document.querySelectorAll(".viewxmlheader");for(var i=0;i<v.length;i++){var d=v[i];var c=d.getAttribute("collapsed")==="true";if(!c){var w=d.offsetWidth-30;var h=d.nextSibling.firstChild.offsetHeight;d._iOldWidth=w;d._iOldHeight=h;d.nextSibling.firstChild.style.width=(w/3*2)+"px";d.nextSibling.lastChild.style.width=(w/3)+"px";d.nextSibling.lastChild.style.height=(h)+"px";d.nextSibling.lastChild.style.marginTop=(-h)+"px";d.nextSibling.lastChild.style.marginLeft=((w/3*2)+20)+"px";d.nextSibling.lastChild.lastChild.height=(h-50)+"px";d.nextSibling.lastChild.lastChild.width="100%";}}if(!this.iInterval){var t=this;this.iInterval=window.setInterval(function(){var v=document.querySelectorAll(".viewxmlheader");var d=v[0];for(var i=0;i<v.length;i++){var d=v[i];var c=d.getAttribute("collapsed")==="true";if(!c){if(d._iOldWidth!==d.offsetWidth-30||d._iOldHeight!==d.nextSibling.firstChild.offsetHeight){t.resizeHandler();}}}},100);}};V.prototype._onMainViewInfo=function(e){var d=e.target,r=d.getAttribute("raise");if(r&&this[r]){this[r](e);e.stopPropagation();return;}};V.prototype._onToggleViewInfo=function(e){var d=e.target,r=d.getAttribute("raise");if(r&&this[r]){this[r](e);e.stopPropagation();return;}r=d.parentNode.getAttribute("raise");if(r&&this[r]){this[r](e);e.stopPropagation();return;}if(!d.getAttribute("collapsed")){d=d.parentNode;}var c=d.getAttribute("collapsed")==="true";if(c){d.setAttribute("collapsed","false");d.nextSibling.style.display="block";this.resizeHandler();}else{d.setAttribute("collapsed","true");d.nextSibling.style.display="none";}};V.prototype.getValidDebugStackIndices=function(N){var r=[],I=N.getAttribute("support:data"),b=["xmlns","support:data"];if(I){var c=I.split(","),s=this.supportInfo,l=0;for(var i=0;i<c.length;i++){var d=parseInt(c[i]);var o=s.byIndex(d);if(!o){continue;}o.__debugging=s.hasBreakpointAt(d);if(o.env){if(o.env.caller==="visitAttributes"){for(var n in o.env){if(n==="caller"||n==="info"){continue;}var v=true;for(var j=0;j<b.length;j++){if(o.env[n].name.indexOf(b[j])===0){v=false;break;}}if(v){if(n.indexOf("after")===0){l--;}o.__infokey=n+":"+o.env[n].name;o.__level=l;o.__infovalue=o.env[n].value;if(n.indexOf("before")===0){l++;}r.push(o);}}}else if(o.env.caller==="getMetadata"){for(var n in o.env){if(n==="caller"||n==="info"){continue;}var v=true;for(var j=0;j<b.length;j++){if(o.env[n].name.indexOf(b[j])===0){v=false;break;}}if(v){if(n.indexOf("after")===0){l--;}o.__infokey=n+":"+o.env[n].name;o.__level=l;o.__infovalue=o.env[n].value;r.push(o);if(n.indexOf("before")===0){l++;}}}}else if(o.env.caller==="getProperty"){for(var n in o.env){if(n==="caller"||n==="info"){continue;}var v=true;for(var j=0;j<b.length;j++){if(o.env[n].name.indexOf(b[j])===0){v=false;break;}}if(v){if(n.indexOf("after")===0){l--;}o.__infokey=n+":"+o.env[n].name;o.__level=l;o.__infovalue=o.env[n].value;r.push(o);if(n.indexOf("before")===0){l++;}}}}else if(o.env.caller==="visitNode"){for(var n in o.env){if(n.indexOf("after")===0){l--;}o.__infokey=n+":Node";o.__infovalue=o.env[n].name;r.push(o);if(n.indexOf("before")===0){l++;}}}}}}return r;};return V;});
