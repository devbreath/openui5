/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['sap/ui/base/DataType','sap/ui/base/ManagedObject','sap/ui/core/CustomData','sap/ui/core/Component','./mvc/View','./mvc/ViewType','./mvc/XMLProcessingMode','./mvc/EventHandlerResolver','./ExtensionPoint','./StashedControlSupport','sap/ui/base/SyncPromise','sap/base/Log','sap/base/util/ObjectPath','sap/base/util/values','sap/base/assert','sap/base/util/LoaderExtensions','sap/base/util/JSTokenizer','sap/base/util/each','sap/base/util/isEmptyObject'],function(D,M,C,a,V,b,X,E,c,S,d,L,O,v,f,g,J,h,k){"use strict";function l(e,i,N,j,R){var p=M.bindingParser(i,j,true,false,false,false,R);if(p&&typeof p==="object"){return p;}var I=i=typeof p==="string"?p:i;var K=D.getType(e);if(K){if(K instanceof D){I=K.parseValue(i,{context:j,locals:R});if(!K.isValid(I)){L.error("Value '"+i+"' is not valid for type '"+K.getName()+"'.");}}}else{throw new Error("Property "+N+" has unknown type "+e);}return typeof I==="string"?M.bindingParser.escape(I):I;}function m(e){return e.localName||e.nodeName;}var n="http://www.w3.org/1999/xhtml";var o="http://www.w3.org/2000/xmlns/";var q="http://www.w3.org/2000/svg";var r="sap.ui.core";var s="sap.ui.core.mvc";var t="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1";var u="http://schemas.sap.com/sapui5/extension/sap.ui.core.support.Support.info/1";var w="http://schemas.sap.com/sapui5/extension/sap.ui.core.xmlcomposite/1";var U="http://schemas.sap.com/sapui5/extension/sap.ui.core.Internal/1";var P="http://schemas.sap.com/sapui5/preprocessorextension/";var x=['controllerName','resourceBundleName','resourceBundleUrl','resourceBundleLocale','resourceBundleAlias'];var y=/^(?:area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/;function z(e,j){function p(K,N){var Q,R=[];for(var i=0;i<K.childNodes.length;i++){Q=j(K,K.childNodes[i],N);if(Q){R.push(Q.unwrap());}}return d.resolve(R);}function I(K,N){var Q=Promise.resolve(),R=[N.chain];for(var i=0;i<K.childNodes.length;i++){Q=Q.then(j.bind(null,K,K.childNodes[i],N));R.push(Q);}return Promise.all(R);}return e?I:p;}var A={};A.loadTemplate=function(e,i){var R=e.replace(/\./g,"/")+("."+(i||"view")+".xml");return g.loadResource(R).documentElement;};A.loadTemplatePromise=function(e,i){var R=e.replace(/\./g,"/")+("."+(i||"view")+".xml");return g.loadResource(R,{async:true}).then(function(j){return j.documentElement;});};A.parseViewAttributes=function(e,j){var i,p;for(i=0;i<e.attributes.length;i++){p=e.attributes[i];if(x.includes(p.name)){j["_"+p.name]=p.value;}}};A.enrichTemplateIds=function(e,i){A.enrichTemplateIdsPromise(e,i,false);return e;};A.enrichTemplateIdsPromise=function(e,i,j){return H(e,i,true,j).then(function(){return e;});};A.parseTemplate=function(e,i,j){return A.parseTemplatePromise(e,i,false,{settings:j}).unwrap();};A.parseTemplatePromise=function(e,j,p,I){return H(e,j,false,p,I).then(function(R){if(j.isA("sap.ui.core.mvc.View")){var K,i;for(i=R.length-1;i>=0;i--){K=R[i];if(K&&K._isExtensionPoint){var N=[i,1].concat(K._aControls);Array.prototype.splice.apply(R,N);}}}return R;});};function B(R){var e,i=/^[a-zA-Z_$][a-zA-Z0-9_$]*$/;if(!R||typeof R!=="object"){e="core:require in XMLView can't be parsed to a valid object";}else{Object.keys(R).some(function(K){if(!i.test(K)){e="core:require in XMLView contains invalid identifier: '"+K+"'";return true;}if(!R[K]||typeof R[K]!=="string"){e="core:require in XMLView contains invalid value '"+R[K]+"'under key '"+K+"'";return true;}});}return e;}function F(j,p){var I=j.getAttributeNS(r,"require"),R,K,N;if(I){try{R=J.parseJS(I);}catch(e){L.error("Require attribute can't be parsed on Node: ",j.nodeName);throw e;}N=B(R);if(N){throw new Error(N+" on Node: "+j.nodeName);}if(!k(R)){K={};if(p){return new Promise(function(Q,W){var Y=Object.keys(R).reduce(function(i,Z){K[Z]=sap.ui.require(R[Z]);return i&&K[Z]!==undefined;},true);if(Y){Q(K);return;}sap.ui.require(v(R),function(){var Z=arguments;Object.keys(R).forEach(function($,i){K[$]=Z[i];});Q(K);},W);});}else{Object.keys(R).forEach(function(i){K[i]=sap.ui.requireSync(R[i]);});return d.resolve(K);}}}}function T(e,i,j){var I=d.resolve();if(!k(j)){var K=[];var R;if(e){I=new Promise(function(p){R=p;});}Object.keys(j).forEach(function(N){var Q=j[N];Q.forEach(function(W){W.targetControl=i;var Y=sap.ui.require(W.providerClass);if(Y){K.push(Y.applyExtensionPoint(W));}else{var p=new Promise(function(Z,$){sap.ui.require([W.providerClass],function(_){Z(_);},$);}).then(function(Z){return Z.applyExtensionPoint(W);});K.push(p);}});});if(e){Promise.all(K).then(R);}}return I;}function G(e,i,p){var j=p;for(var I=0;I<100;I++){var R=e.lookupNamespaceURI(j);if(R==null||R===i){return j;}j=p+I;}throw new Error("Could not find an unused namespace prefix after 100 tries, giving up");}function H(p,I,K,N,Q){var R=[],W=G(p,U,"__ui5"),Y=F(p,N)||d.resolve(),Z={openStart:function(e,j){R.push(["openStart",[e,j]]);},voidStart:function(e,j){R.push(["voidStart",[e,j]]);},style:function(e,j){R.push(["style",[e,j]]);},"class":function(e){R.push(["class",[e]]);},attr:function(e,j){R.push(["attr",[e,j]]);},openEnd:function(){R.push(["openEnd"]);},voidEnd:function(){R.push(["voidEnd"]);},text:function(e){R.push(["text",[e]]);},unsafeHtml:function(e){R.push(["unsafeHtml",[e]]);},close:function(e){R.push(["close",[e]]);},renderControl:function(e){R.push(e);}};N=N&&!!I._sProcessingMode;L.debug("XML processing mode is "+(I._sProcessingMode||"default")+".","","XMLTemplateProcessor");L.debug("XML will be processed "+(N?"asynchronously":"synchronously")+".","","XMLTemplateProcessor");var $=sap.ui.getCore().getConfiguration().getDesignMode();if($){I._sapui_declarativeSourceInfo={xmlNode:p,xmlRootNode:I._oContainingView===I?p:I._oContainingView._sapui_declarativeSourceInfo.xmlRootNode};}if(!I.isSubView()){p.setAttributeNS(o,"xmlns:"+W,U);}var _=g1(p,Y);var i=0;function a1(){for(;i<R.length;i++){var e=R[i];if(e&&typeof e.then==='function'){return e.then(b1).then(a1);}}return R;}function b1(e){var j=[i,1].concat(e);Array.prototype.splice.apply(R,j);}return Y.then(a1).then(function(R){if(_){var e=p.parentNode;e.removeChild(p);if(e.parentNode){e.parentNode.replaceChild(p,e);}}return R;});function c1(e){return e;}function d1(e){return I._oContainingView.createId(e);}function e1(e,j){var o1=I.getMetadata().isA("sap.ui.core.mvc.View")?"View":"Fragment";var p1=e.outerHTML?e.cloneNode(false).outerHTML:e.textContent;return"Error found in "+o1+" (id: '"+I.getId()+"').\nXML node: '"+p1+"':\n"+j;}function f1(e){var j=m(e),o1;if(I.isA("sap.ui.core.mvc.XMLView")&&(e.namespaceURI===n||e.namespaceURI===q)){o1=e.ownerDocument.createElementNS(s,"View");}else if(I.isA("sap.ui.core.Fragment")&&(j!=="FragmentDefinition"||e.namespaceURI!==r)){o1=e.ownerDocument.createElementNS(r,"FragmentDefinition");}if(o1){var p1=e.parentNode;if(p1){p1.replaceChild(o1,e);}o1.appendChild(e);}return o1;}function g1(e,j){var _=false,o1=I.sViewName||I._sFragmentName,p1,q1;if(!o1){var r1=I;var s1=0;while(++s1<1000&&r1&&r1!==r1._oContainingView){r1=r1._oContainingView;}o1=r1.sViewName;}p1=f1(e);if(p1){e=p1;_=true;}q1=m(e);if(I.isA("sap.ui.core.mvc.XMLView")){if((q1!=="View"&&q1!=="XMLView")||e.namespaceURI!==s){L.error("XMLView's root node must be 'View' or 'XMLView' and have the namespace 'sap.ui.core.mvc'"+(o1?" (View name: "+o1+")":""));}Y=j.then(function(){return k1(e,I.getMetadata().getClass(),j,null,{rootArea:true,rootNode:true});});}else{var t1=z(N,function(e,u1,v1){if(u1.nodeType===1){return i1(u1,v1.chain,null,undefined,{rootArea:true});}});Y=j.then(function(){return t1(e,{chain:j});});}return _;}function h1(e,j){var o1;var p1=sap.ui.getCore().getLoadedLibraries();h(p1,function(t1,u1){if(e===u1.namespace||e===u1.name){o1=u1.name+"."+((u1.tagNames&&u1.tagNames[j])||j);}});o1=o1||e+"."+j;function q1(s1){if(!s1){L.error("Control '"+o1+"' did not return a class definition from sap.ui.define.","","XMLTemplateProcessor");s1=O.get(o1);}if(!s1){L.error("Can't find object class '"+o1+"' for XML-view","","XMLTemplateProcessor");}return s1;}var r1=o1.replace(/\./g,"/");var s1=sap.ui.require(r1);if(!s1){if(N){return new Promise(function(t1,u1){sap.ui.require([r1],function(s1){s1=q1(s1);t1(s1);},u1);});}else{s1=sap.ui.requireSync(r1);s1=q1(s1);}}return s1;}function i1(e,j,o1,p1,q1){var r1=q1&&q1.rootArea,s1=q1&&q1.rootNode&&I.isSubView(),t1=m(e),u1=r1&&(I.isA("sap.ui.core.Fragment")||(p1&&p1.name==="content")),v1,i;if(e.nodeType===1){if(e.namespaceURI===n||e.namespaceURI===q){if(r1){if(p1&&p1.name!=="content"){L.error(e1(e,"XHTML nodes can only be added to the 'content' aggregation and not to the '"+p1.name+"' aggregation."));return d.resolve([]);}if(q1&&q1.contentBound){throw new Error(e1(e,"No XHTML or SVG node is allowed because the 'content' aggregation is bound."));}var w1=e.namespaceURI===n;var x1=e.getAttribute("id");if(x1!=null){x1=m1(I,e);}else{x1=s1?I.getId():undefined;}if(t1==="style"){var y1=e.attributes;var z1=e.textContent;e=document.createElement(t1);e.textContent=z1;for(i=0;i<y1.length;i++){var A1=y1[i];if(!A1.prefix){e.setAttribute(A1.name,A1.value);}}if(x1!=null){e.setAttribute("id",x1);}if(s1){e.setAttribute("data-sap-ui-preserve",I.getId());}Z.unsafeHtml(e.outerHTML);return d.resolve([]);}var B1=y.test(t1);if(B1){Z.voidStart(t1,x1);}else{Z.openStart(t1,x1);}for(i=0;i<e.attributes.length;i++){var C1=e.attributes[i];if(C1.name!=="id"){Z.attr(w1?C1.name.toLowerCase():C1.name,C1.value);}}if(s1){Z.attr("data-sap-ui-preserve",I.getId());}if(B1){Z.voidEnd();if(e.firstChild){L.error("Content of void HTML element '"+t1+"' will be ignored");}}else{Z.openEnd();var D1=e instanceof HTMLTemplateElement?e.content:e;var E1=z(N,function(e,F1,H1){return i1(F1,H1.chain,H1.closestBinding,H1.aggregation,H1.config);});v1=E1(D1,{chain:j,closestBinding:o1,aggregation:p1,config:{rootArea:r1}});return v1.then(function(F1){Z.close(t1);return F1.reduce(function(H1,I1){if(Array.isArray(I1)){I1.forEach(function(J1){H1.push(J1);});}return H1;},[]);});}}else{var id=e.attributes['id']?e.attributes['id'].textContent||e.attributes['id'].text:null;if(K){return A.enrichTemplateIdsPromise(e,I,N).then(function(){return[];});}else{var G1=function(F1){var H1={id:id?m1(I,e,id):undefined,xmlNode:e,containingView:I._oContainingView,processingMode:I._sProcessingMode};if(I.fnScopedRunWithOwner){return I.fnScopedRunWithOwner(function(){return new F1(H1);});}return new F1(H1);};return j.then(function(){if(N){return new Promise(function(H1,I1){sap.ui.require(["sap/ui/core/mvc/XMLView"],function(F1){H1([G1(F1)]);},I1);});}else{var F1=sap.ui.requireSync("sap/ui/core/mvc/XMLView");return[G1(F1)];}});}}}else{v1=j1(e,j,o1);if(u1){Z.renderControl(v1);}return v1;}}else if(e.nodeType===3&&u1){if(!q1||!q1.contentBound){Z.text(e.textContent);}else if(e.textContent.trim()){throw new Error(e1(e,"Text node isn't allowed because the 'content' aggregation is bound."));}}return d.resolve([]);}function j1(e,j,o1){if(m(e)==="ExtensionPoint"&&e.namespaceURI===r){if(K){return d.resolve([]);}else{var p1=I instanceof V?I._oContainingView:I;var q1=c._factory.bind(null,p1,e.getAttribute("name"),function(){var w1=d.resolve();var x1=[];var y1=e.childNodes;for(var i=0;i<y1.length;i++){var z1=y1[i];if(z1.nodeType===1){w1=w1.then(i1.bind(null,z1,j,o1));x1.push(w1);}}return d.all(x1).then(function(A1){var B1=[];A1.forEach(function(C1){B1=B1.concat(C1);});return B1;});},undefined,undefined,N);return d.resolve(I.fnScopedRunWithOwner?I.fnScopedRunWithOwner(q1):q1());}}else{var r1=m(e);var s1=r1;var t1=r1.lastIndexOf(".");if(t1>=0){s1=r1.substring(t1+1,r1.length);}if(/^[a-z].*/.test(s1)){var u1=I.sViewName||I._sFragmentName||I.getId();L.warning("View or Fragment '"+u1+"' contains a Control tag that starts with lower case '"+s1+"'",I.getId(),"sap.ui.core.XMLTemplateProcessor#lowerCase");}var v1=h1(e.namespaceURI,r1);if(v1&&typeof v1.then==='function'){return v1.then(function(w1){return k1(e,w1,j,o1);});}else{return k1(e,v1,j,o1);}}}function k1(o1,p1,q1,r1,s1){var ns=o1.namespaceURI,u1={},v1={},w1="",x1=[],y1=null,z1=null,A1=o1.getAttribute("stashed")==="true",B1=s1&&s1.rootArea,C1=s1&&s1.rootNode,D1;if(!K){o1.removeAttribute("stashed");}if(!p1){return d.resolve([]);}if(C1){u1.id=I.getId();}var E1=p1.getMetadata();var F1=E1.getAllSettings();var G1=!B1?F(o1,N):undefined;if(G1){q1=d.all([q1,G1]).then(function(e){return Object.assign({},e[0],e[1]);});}q1=q1.then(function(j){if(k(j)){j=null;}D1=j;if(!K){for(var i=0;i<o1.attributes.length;i++){var t1=o1.attributes[i],L1=t1.name,M1=t1.namespaceURI,N1=F1[L1],O1=t1.value;if(C1&&x.includes(L1)){continue;}if(L1==="id"&&!C1){u1[L1]=m1(I,o1,O1);}else if(L1==="class"){w1+=O1;}else if(L1==="viewName"){u1[L1]=O1;}else if(L1==="fragmentName"){u1[L1]=O1;u1['containingView']=I._oContainingView;}else if((L1==="binding"&&!N1)||L1==='objectBindings'){if(!A1){var P1=M.bindingParser(O1,I._oContainingView.oController);if(P1){u1.objectBindings=u1.objectBindings||{};u1.objectBindings[P1.model||undefined]=P1;}}}else if(L1==='metadataContexts'){if(!A1){var Q1=null;try{Q1=A._calculatedModelMapping(O1,I._oContainingView.oController,true);}catch(e){L.error(I+":"+e.message);}if(Q1){u1.metadataContexts=Q1;if(A._preprocessMetadataContexts){A._preprocessMetadataContexts(p1.getMetadata().getName(),u1,I._oContainingView.oController);}}}}else if(L1.indexOf(":")>-1){M1=t1.namespaceURI;if(M1===t){var R1=m(t1);x1.push(new C({key:R1,value:l("any",O1,R1,I._oContainingView.oController,j)}));}else if(M1===u){z1=O1;}else if(M1&&M1.startsWith(P)){L.debug(I+": XMLView parser ignored preprocessor attribute '"+L1+"' (value: '"+O1+"')");}else if(M1===U&&m(t1)==="invisible"){N1=F1.visible;if(N1&&N1._iKind===0&&N1.type==="boolean"){u1.visible=false;}}else if(M1===r||M1===U||L1.startsWith("xmlns:")){}else{if(!y1){y1={};}if(!y1.hasOwnProperty(t1.namespaceURI)){y1[t1.namespaceURI]={};}y1[t1.namespaceURI][m(t1)]=t1.nodeValue;L.debug(I+": XMLView parser encountered unknown attribute '"+L1+"' (value: '"+O1+"') with unknown namespace, stored as sap-ui-custom-settings of customData");}}else if(N1&&N1._iKind===0){u1[L1]=l(N1.type,O1,L1,I._oContainingView.oController,j);}else if(N1&&N1._iKind===1&&N1.altTypes){if(!A1){u1[L1]=l(N1.altTypes[0],O1,L1,I._oContainingView.oController,j);}}else if(N1&&N1._iKind===2){if(!A1){var P1=M.bindingParser(O1,I._oContainingView.oController,false,false,false,false,j);if(P1){u1[L1]=P1;}else{L.error(I+": aggregations with cardinality 0..n only allow binding paths as attribute value (wrong value: "+L1+"='"+O1+"')");}}}else if(N1&&N1._iKind===3){if(!A1){u1[L1]=d1(O1);}}else if(N1&&N1._iKind===4){if(!A1){u1[L1]=O1.split(/[\s,]+/g).filter(c1).map(d1);}}else if(N1&&N1._iKind===5){if(!A1){var S1=[];E.parse(O1).forEach(function(T1){var U1=E.resolveEventHandler(T1,I._oContainingView.oController,j);if(U1){S1.push(U1);}else{L.warning(I+": event handler function \""+T1+"\" is not a function or does not exist in the controller.");}});if(S1.length){u1[L1]=S1;}}}else if(N1&&N1._iKind===-1){if(E1.isA("sap.ui.core.mvc.View")&&L1=="async"){u1[L1]=l(N1.type,O1,L1,I._oContainingView.oController,j);}else{L.warning(I+": setting '"+L1+"' for class "+E1.getName()+" (value:'"+O1+"') is not supported");}}else{f(L1==='xmlns',I+": encountered unknown setting '"+L1+"' for class "+E1.getName()+" (value:'"+O1+"')");if(A._supportInfo){A._supportInfo({context:o1,env:{caller:"createRegularControls",error:true,info:"unknown setting '"+L1+"' for class "+E1.getName()}});}}}if(y1){x1.push(new C({key:"sap-ui-custom-settings",value:y1}));}if(x1.length>0){u1.customData=x1;}}return j;}).catch(function(e){if(!e.isEnriched){e=new Error(e1(o1,e));e.isEnriched=true;L.error(e);}if(N&&I._sProcessingMode!==X.SequentialLegacy){throw e;}});var H1=z(N,I1);function I1(o1,e,t1){var J1=t1.aggregation,K1=t1.allAggregations,q1=t1.chain,r1=t1.closestBinding,s1=t1.config,L1,M1;if(e.nodeType===1){if(e.namespaceURI===w){u1[m(e)]=e.querySelector("*");return undefined;}L1=e.namespaceURI===ns&&K1&&K1[m(e)];if(L1){return H1(e,{aggregation:L1,allAggregations:null,chain:q1,closestBinding:r1,config:s1});}else if(J1){if(e.getAttribute("stashed")==="true"&&!K){var N1=e;e=e.cloneNode();N1.removeAttribute("stashed");M1=function(){var j=m1(I,e);S.createStashedControl({wrapperId:j,fnCreate:function(){var P1=N;N=false;try{return I1(o1,N1,{aggregation:J1,allAggregations:K1,chain:d.resolve(D1),closestBinding:r1}).unwrap();}finally{N=P1;}}});};if(I.fnScopedRunWithOwner){I.fnScopedRunWithOwner(M1);}else{M1();}e.removeAttribute("visible");l1(e,"invisible");}if(u1[J1.name]&&typeof u1[J1.name].path==="string"){r1={aggregation:J1.name,id:u1.id};if(C1&&J1.name==="content"){s1=s1||{};s1.contentBound=true;}}return i1(e,q1,r1,J1,s1).then(function(P1){for(var j=0;j<P1.length;j++){var Q1=P1[j];var R1=J1.name;if(Q1._isExtensionPoint){if(!u1[R1]){u1[R1]=[];}var S1=v1[R1];if(!S1){S1=v1[R1]=[];}Q1.index=u1[R1].length;Q1.aggregationName=R1;Q1.closestAggregationBindingCarrier=r1&&r1.id;Q1.closestAggregationBinding=r1&&r1.aggregation;var T1=S1[S1.length-1];if(T1){T1._nextSibling=Q1;}S1.push(Q1);}else if(J1.multiple){if(!u1[R1]){u1[R1]=[];}if(typeof u1[R1].path==="string"){f(!u1[R1].template,"list bindings support only a single template object");u1[R1].template=Q1;}else{u1[R1].push(Q1);}}else{f(!u1[R1],"multiple aggregates defined for aggregation with cardinality 0..1");u1[R1]=Q1;}}return P1;});}else{throw new Error(e1(e,"Cannot add direct child without default aggregation defined for control "+E1.getElementName()));}}else if(e.nodeType===3){if(s1&&s1.rootArea){i1(e,q1,r1,J1,s1);}else{var O1=e.textContent||e.text;if(O1&&O1.trim()){throw new Error(e1(e,"Cannot add text nodes as direct child of an aggregation. For adding text to an aggregation, a surrounding html tag is needed."));}}}}var J1=E1.getDefaultAggregation();var K1=E1.getAllAggregations();return H1(o1,{aggregation:J1,allAggregations:K1,chain:q1,closestBinding:r1,config:s1}).then(function(){var e;var j=d.resolve();var t1=d.resolve();var L1=o1.getAttribute("type");var M1=a.getOwnerComponentFor(I);var N1=M1&&M1.isA("sap.ui.core.IAsyncContentCreation");if(K){if(!B1&&o1.hasAttribute("id")){n1(I,o1);}}else if(!C1&&p1.getMetadata().isA("sap.ui.core.mvc.View")){var O1=function(){if(!p1._sType&&!u1.viewName){u1.viewName="module:"+p1.getMetadata().getName().replace(/\./g,"/");}if(N1&&N){if(u1.async===false){throw new Error("A nested view contained in a Component implementing 'sap.ui.core.IAsyncContentCreation' is processed asynchronously by default and cannot be processed synchronously.\n"+"Affected Component '"+M1.getMetadata().getComponentName()+"' and View '"+u1.viewName+"'.");}u1.type=p1._sType||L1;t1=V.create(u1);}else{if(p1.getMetadata().isA("sap.ui.core.mvc.XMLView")&&I._sProcessingMode){u1.processingMode=I._sProcessingMode;}return V._create(u1,undefined,p1._sType||L1);}};if(I.fnScopedRunWithOwner){e=I.fnScopedRunWithOwner(O1);}else{e=O1();}}else if(p1.getMetadata().isA("sap.ui.core.Fragment")&&N){if(L1!==b.JS){u1.processingMode=I._sProcessingMode;}var P1="sap/ui/core/Fragment";var Q1=sap.ui.require(P1);u1.name=u1.name||u1.fragmentName;if(Q1){t1=Q1.load(u1);}else{t1=new Promise(function(S1,T1){sap.ui.require([P1],function(Q1){Q1.load(u1).then(function(U1){S1(U1);});},T1);});}}else{var R1=function(){var S1;if(C1){S1=I;if(!N){if(Q&&Q.settings){Object.keys(u1).forEach(function(T1){if(Q.settings.hasOwnProperty(T1)){Q.settings[T1]=u1[T1];delete u1[T1];}});}}I.applySettings(u1);}else if(I.fnScopedRunWithOwner){S1=I.fnScopedRunWithOwner(function(){var S1=new p1(u1);return S1;});}else{S1=new p1(u1);}j=T(N,S1,v1);return S1;};if(Q&&Q.fnRunWithPreprocessor){e=Q.fnRunWithPreprocessor(R1);}else{e=R1();}}return t1.then(function(S1){return S1||e;}).then(function(S1){if(w1&&S1.addStyleClass){S1.addStyleClass(w1);}if(!S1){S1=[];}else if(!Array.isArray(S1)){S1=[S1];}if(A._supportInfo&&S1){for(var i=0,T1=S1.length;i<T1;i++){var U1=S1[i];if(U1&&U1.getId()){var V1=A._supportInfo({context:o1,env:{caller:"createRegularControls",nodeid:o1.getAttribute("id"),controlid:U1.getId()}}),W1=z1?z1+",":"";W1+=V1;A._supportInfo.addSupportInfo(U1.getId(),W1);}}}if($){S1.forEach(function(U1){if(E1.getCompositeAggregationName){var X1=o1.getElementsByTagName(U1.getMetadata().getCompositeAggregationName());for(var i=0;i<X1.length;i++){o1.removeChild(X1[0]);}}U1._sapui_declarativeSourceInfo={xmlNode:o1,xmlRootNode:I._sapui_declarativeSourceInfo.xmlRootNode,fragmentName:E1.getName()==='sap.ui.core.Fragment'?u1['fragmentName']:null};});}return j.then(function(){return S1;});});});}function l1(e,j){var o1=G(e,U,W);e.setAttributeNS(U,o1+":"+j,"true");}function m1(I,p,e){if(p.getAttributeNS(U,"id")){return p.getAttribute("id");}else{return d1(e?e:p.getAttribute("id"));}}function n1(I,p){p.setAttribute("id",d1(p.getAttribute("id")));l1(p,"id");}}A._preprocessMetadataContexts=null;A._calculatedModelMapping=function(e,j,p){var I,K={},N=M.bindingParser(e,j);function Q(R){if(R.length%2===0){throw new Error("The last entry is no binding");}for(var i=1;i<=R.length;i=i+2){if(typeof R[i-1]=='string'){throw new Error("Binding expected not a string");}if(R[i]){if((typeof R[i]!='string')||(R[i]!=",")){throw new Error("Missing delimiter ','");}}}}if(N){if(!N.formatter){I=N;N={parts:[I]};}else{Q(N.formatter.textFragments);}for(var i=0;i<N.parts.length;i++){I=N.parts[i];K[I.model]=K[I.model]||(p?[]:null);if(Array.isArray(K[I.model])){K[I.model].push(I);}else{K[I.model]=I;}}}return K;};return A;},true);
