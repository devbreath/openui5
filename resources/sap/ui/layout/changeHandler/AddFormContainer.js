/*!
 * OpenUI5
 * (c) Copyright 2009-2022 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/changeHandler/Base","sap/ui/core/util/reflection/JsControlTreeModifier"],function(B,J){"use strict";var A={};A.applyChange=function(c,f,p){var m=p.modifier;var a=p.appComponent;var v=p.view;var C=c.getContent();var t=c.getTexts();if(t&&t.groupLabel&&t.groupLabel.value&&C&&C.group&&(C.group.selector||C.group.id)){var T=t.groupLabel.value;var i=C.group.index;var n=C.group.selector||{id:C.group.id};var N=Object.assign({},n);N.id=N.id+"--title";c.setRevertData({newGroupSelector:n});if(m.bySelector(N,a)){return B.markAsNotApplicable("Control to be created already exists:"+N);}else if(m.bySelector(n,a)){return B.markAsNotApplicable("Control to be created already exists:"+n);}return Promise.resolve().then(function(){return Promise.all([m.createControl("sap.ui.core.Title",a,v,N),m.createControl("sap.ui.layout.form.FormContainer",a,v,n)]);}).then(function(b){var o=b[0];var g=b[1];m.setProperty(o,"text",T);return Promise.resolve().then(m.insertAggregation.bind(m,g,"title",o,0,v)).then(m.insertAggregation.bind(m,f,"formContainers",g,i,v));});}else{return Promise.resolve();}};A.completeChangeContent=function(c,s,p){var a=p.appComponent;if(s.newLabel){c.setText("groupLabel",s.newLabel,"XFLD");}else{throw new Error("Cannot create a new group: oSpecificChangeInfo.groupLabel attribute required");}var C={group:{}};if(s.index===undefined){throw new Error("Cannot create a new group: oSpecificChangeInfo.index attribute required");}else{C.group.index=s.index;}if(s.newControlId){C.group.selector=J.getSelector(s.newControlId,a);}else{throw new Error("Cannot create a new group: oSpecificChangeInfo.newControlId attribute required");}c.setContent(C);};A.revertChange=function(c,f,p){var a=p.appComponent;var v=p.view;var m=p.modifier;var n=c.getRevertData().newGroupSelector;var g=m.bySelector(n,a,v);return Promise.resolve().then(function(){return m.removeAggregation(f,"formContainers",g);}).then(function(){m.destroy(g);c.resetRevertData();});};return A;},true);
