sap.ui.define(["sap/ui/webc/common/thirdparty/base/UI5Element","sap/ui/webc/common/thirdparty/base/renderer/LitRenderer","sap/ui/webc/common/thirdparty/base/types/Float","sap/ui/webc/common/thirdparty/base/types/Integer","sap/ui/webc/common/thirdparty/base/delegate/ResizeHandler","sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/icons/source-code","sap/ui/webc/common/thirdparty/base/Keys","./generated/themes/SliderBase.css"],function(e,t,i,s,r,n,a,o,l){"use strict";function h(e){return e&&typeof e==="object"&&"default"in e?e["default"]:e}var c=h(e);var u=h(t);var p=h(i);var d=h(s);var _=h(r);const f={properties:{min:{type:p,defaultValue:0},max:{type:p,defaultValue:100},step:{type:p,defaultValue:1},labelInterval:{type:d,defaultValue:0},showTickmarks:{type:Boolean},showTooltip:{type:Boolean},disabled:{type:Boolean},accessibleName:{type:String},_tooltipVisibility:{type:String,defaultValue:"hidden"},_labelsOverlapping:{type:Boolean},_hiddenTickmarks:{type:Boolean}},events:{change:{},input:{}}};class m extends c{constructor(){super();this._resizeHandler=this._handleResize.bind(this);this._moveHandler=this._handleMove.bind(this);this._upHandler=this._handleUp.bind(this);this._stateStorage={step:null,min:null,max:null,labelInterval:null};const e=e=>{this._onmousedown(e)};this._ontouchstart={handleEvent:e,passive:true}}static get metadata(){return f}static get render(){return u}static get styles(){return l}static get UP_EVENTS(){return["mouseup","touchend"]}static get MOVE_EVENT_MAP(){return{mousedown:"mousemove",touchstart:"touchmove"}}static get ACTION_KEYS(){return[o.isLeft,o.isRight,o.isUp,o.isDown,o.isLeftCtrl,o.isRightCtrl,o.isUpCtrl,o.isDownCtrl,o.isPlus,o.isMinus,o.isHome,o.isEnd,o.isPageUp,o.isPageDown,o.isEscape]}static get MIN_SPACE_BETWEEN_TICKMARKS(){return 8}static get TOOLTIP_VISIBILITY(){return{VISIBLE:"visible",HIDDEN:"hidden"}}get classes(){return{root:{"ui5-slider-root-phone":n.isPhone()},labelContainer:{"ui5-slider-hidden-labels":this._labelsOverlapping}}}onEnterDOM(){_.register(this,this._resizeHandler)}onExitDOM(){_.deregister(this,this._handleResize)}onAfterRendering(){if(this.notResized){this._resizeHandler()}}_onmouseover(e){if(this.showTooltip){this._tooltipVisibility=m.TOOLTIP_VISIBILITY.VISIBLE}}_onmouseout(e){if(this.showTooltip&&!this.shadowRoot.activeElement){this._tooltipVisibility=m.TOOLTIP_VISIBILITY.HIDDEN}}_setInitialValue(e,t){this[`_${e}Initial`]=t}_getInitialValue(e){return this[`_${e}Initial`]}_onkeydown(e){if(this.disabled||this._effectiveStep===0){return}if(m._isActionKey(e)){e.preventDefault();this._isUserInteraction=true;this._handleActionKeyPress(e)}}_onkeyup(e){if(this.disabled){return}this._isUserInteraction=false}_preserveFocus(e){this._isInnerElementFocusing=e}_isFocusing(){return this._isInnerElementFocusing}_preventFocusOut(){this.focusInnerElement()}focusInnerElement(){this.focus()}_handleResize(){if(!this.showTickmarks){return}this.notResized=false;const e=this._spaceBetweenTickmarks();if(e<m.MIN_SPACE_BETWEEN_TICKMARKS){this._hiddenTickmarks=true;this._labelsOverlapping=true}else{this._hiddenTickmarks=false}if(this.labelInterval<=0||this._hiddenTickmarks){return}const t=this.shadowRoot.querySelectorAll(".ui5-slider-labels li");this._labelsOverlapping=[...t].some(e=>e.scrollWidth>e.clientWidth)}handleDownBase(e){const t=this._effectiveMin;const i=this._effectiveMax;const s=this.getBoundingClientRect();const r=this.directionStart;const n=this._effectiveStep;const a=m.getValueFromInteraction(e,n,t,i,s,r);this._isUserInteraction=true;this._moveEventType=!this._moveEventType?m.MOVE_EVENT_MAP[e.type]:this._moveEventType;m.UP_EVENTS.forEach(e=>window.addEventListener(e,this._upHandler));window.addEventListener(this._moveEventType,this._moveHandler);this._handleFocusOnMouseDown(e);return a}_handleFocusOnMouseDown(e){const t=this.shadowRoot.activeElement;if(!t||t!==e.target){this._preserveFocus(true);this.focusInnerElement()}}handleUpBase(e){m.UP_EVENTS.forEach(e=>window.removeEventListener(e,this._upHandler));window.removeEventListener(this._moveEventType,this._moveHandler);this._moveEventType=null;this._isUserInteraction=false;this._preserveFocus(false)}updateValue(e,t){this[e]=t;this.storePropertyState(e);if(this._isUserInteraction){this.fireEvent("input")}}static _isActionKey(e){return this.ACTION_KEYS.some(t=>t(e))}static clipValue(e,t,i){e=Math.min(Math.max(e,t),i);return e}static getValueFromInteraction(e,t,i,s,r,n){const a=this.getPageXValueFromEvent(e);const o=this.computedValueFromPageX(a,i,s,r,n);const l=this.getSteppedValue(o,t,i);return this.clipValue(l,i,s)}static getSteppedValue(e,t,i){const s=Math.abs((e-i)%t);if(t===0||s===0){return e}e=s*2>=t?e+t-s:e-s;const r=m._getDecimalPrecisionOfNumber(t);return e.toFixed(r)}static getPageXValueFromEvent(e){if(e.targetTouches&&e.targetTouches.length>0){return e.targetTouches[0].pageX}return e.pageX}static computedValueFromPageX(e,t,i,s,r){const n=r==="left"?e-s[r]:s[r]-e;const a=n/s.width;return t+a*(i-t)}static _getDecimalPrecisionOfNumber(e){if(Number.isInteger(e)){return 0}const t=String(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return Math.max(0,(t[1]?t[1].length:0)-(t[2]?Number(t[2]):0))}syncUIAndState(...e){if(this.isPropertyUpdated("step")){this._validateStep(this.step);this.storePropertyState("step")}if(this.isPropertyUpdated("min","max",...e)){this.storePropertyState("min","max");e.forEach(e=>{const t=m.clipValue(this[e],this._effectiveMin,this._effectiveMax);this.updateValue(e,t);this.storePropertyState(e)})}if(this.labelInterval&&this.showTickmarks){this._createLabels()}if(this.isPropertyUpdated("labelInterval")){this.storePropertyState("labelInterval")}}isCurrentStateOutdated(){return Object.entries(this._stateStorage).some(([e,t])=>this[e]!==t)}getStoredPropertyState(e){return this._stateStorage[e]}isPropertyUpdated(...e){return e.some(e=>this.getStoredPropertyState(e)!==this[e])}storePropertyState(...e){e.forEach(e=>{this._stateStorage[e]=this[e]})}get directionStart(){return this.effectiveDir==="rtl"?"right":"left"}_createLabels(){if(!this.labelInterval||!this.showTickmarks){return}const e=this.labelInterval;const t=this._effectiveStep;const i=(this._effectiveMax-this._effectiveMin)/(t*e);if(i===this._oldNumberOfLabels){return}this._oldNumberOfLabels=i;this._labelWidth=100/i;this._labelValues=[];const s=m._getDecimalPrecisionOfNumber(t);for(let r=0;r<=i;r++){const i=(r*t*e+this._effectiveMin).toFixed(s);this._labelValues.push(i)}}_handleActionKeyPressBase(e,t){const i=m._isIncreaseValueAction(e);const s=m._isBigStepAction(e);const r=this[t];const n=this._effectiveMin;const a=this._effectiveMax;let l=this.effectiveDir==="rtl"?-this._effectiveStep:this._effectiveStep;l=s&&(a-n)/l>10?(a-n)/10:l;if(o.isEnd(e)){return a-r}if(o.isHome(e)){return(r-n)*-1}return i?l:l*-1}static _isDecreaseValueAction(e){return o.isDown(e)||o.isDownCtrl(e)||o.isLeft(e)||o.isLeftCtrl(e)||o.isMinus(e)||o.isPageDown(e)}static _isIncreaseValueAction(e){return o.isUp(e)||o.isUpCtrl(e)||o.isRight(e)||o.isRightCtrl(e)||o.isPlus(e)||o.isPageUp(e)}static _isBigStepAction(e){return o.isDownCtrl(e)||o.isUpCtrl(e)||o.isLeftCtrl(e)||o.isRightCtrl(e)||o.isPageUp(e)||o.isPageDown(e)}get _tickmarksCount(){return(this._effectiveMax-this._effectiveMin)/this._effectiveStep}_spaceBetweenTickmarks(){return this.getBoundingClientRect().width/this._tickmarksCount}_validateStep(e){if(e===0){console.warn("The 'step' property must be a positive float number")}if(e<0){console.warn("The 'step' property must be a positive float number. The provided negative number has been converted to its positve equivalent")}if(typeof e!=="number"||Number.isNaN(e)){console.warn("The 'step' property must be a positive float number. It has been set to its default value of 1")}}get _labels(){return this._labelValues||[]}get _effectiveStep(){let e=this.step;if(e<0){e=Math.abs(e)}if(typeof e!=="number"||Number.isNaN(e)){e=1}return e}get _effectiveMin(){return Math.min(this.min,this.max)}get _effectiveMax(){return Math.max(this.min,this.max)}get tabIndex(){return this.disabled?"-1":"0"}get _ariaLabelledByHandleRefs(){return[`${this._id}-accName`,`${this._id}-sliderDesc`].join(" ").trim()}}return m});