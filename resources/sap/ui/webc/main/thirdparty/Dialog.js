sap.ui.define(["sap/ui/webc/common/thirdparty/base/Device","sap/ui/webc/common/thirdparty/base/util/clamp","sap/ui/webc/common/thirdparty/base/Keys","./Popup","sap/ui/webc/common/thirdparty/icons/resize-corner","./Icon","./generated/templates/DialogTemplate.lit","./generated/themes/BrowserScrollbar.css","./generated/themes/PopupsCommon.css","./generated/themes/Dialog.css"],function(e,t,i,s,n,r,h,o,a,d){"use strict";function l(e){return e&&typeof e==="object"&&"default"in e?e["default"]:e}var c=l(t);const u=16;const _={tag:"ui5-dialog",slots:{header:{type:HTMLElement},footer:{type:HTMLElement}},properties:{headerText:{type:String},stretch:{type:Boolean},draggable:{type:Boolean},resizable:{type:Boolean},onPhone:{type:Boolean},onDesktop:{type:Boolean}}};class p extends s{constructor(){super();this._screenResizeHandler=this._center.bind(this);this._dragMouseMoveHandler=this._onDragMouseMove.bind(this);this._dragMouseUpHandler=this._onDragMouseUp.bind(this);this._resizeMouseMoveHandler=this._onResizeMouseMove.bind(this);this._resizeMouseUpHandler=this._onResizeMouseUp.bind(this)}static get metadata(){return _}static get dependencies(){return[r]}static get template(){return h}static get styles(){return[o,a,d]}static _isHeader(e){return e.classList.contains("ui5-popup-header-root")||e.getAttribute("slot")==="header"}async show(e=false){await super._open(e)}get isModal(){return true}get shouldHideBackdrop(){return false}get _ariaLabelledBy(){let e;if(this.headerText!==""&&!this._ariaLabel){e="ui5-popup-header-text"}return e}get _ariaModal(){return true}get _displayProp(){return"flex"}get _displayHeader(){return this.header.length||this.headerText||this.draggable||this.resizable}get _movable(){return!this.stretch&&this.onDesktop&&(this.draggable||this.resizable)}get _headerTabIndex(){return this._movable?"0":undefined}get _showResizeHandle(){return this.resizable&&this.onDesktop}get _minHeight(){let e=Number.parseInt(window.getComputedStyle(this.contentDOM).minHeight);const t=this._root.querySelector(".ui5-popup-header-root");if(t){e+=t.offsetHeight}const i=this._root.querySelector(".ui5-popup-footer-root");if(i){e+=i.offsetHeight}return e}_show(){super._show();this._center()}onBeforeRendering(){this._isRTL=this.effectiveDir==="rtl";this.onPhone=e.isPhone();this.onDesktop=e.isDesktop()}onAfterRendering(){if(!this.isOpen()&&this.open){this.show()}else if(this.isOpen()&&!this.open){this.close()}}onEnterDOM(){super.onEnterDOM();this._attachScreenResizeHandler()}onExitDOM(){super.onExitDOM();this._detachScreenResizeHandler()}_resize(){super._resize();if(this._screenResizeHandlerAttached){this._center()}}_attachScreenResizeHandler(){if(!this._screenResizeHandlerAttached){window.addEventListener("resize",this._screenResizeHandler);this._screenResizeHandlerAttached=true}}_detachScreenResizeHandler(){if(this._screenResizeHandlerAttached){window.removeEventListener("resize",this._screenResizeHandler);this._screenResizeHandlerAttached=false}}_center(){const e=window.innerHeight-this.offsetHeight,t=window.innerWidth-this.offsetWidth;Object.assign(this.style,{top:`${Math.round(e/2)}px`,left:`${Math.round(t/2)}px`})}_revertSize(){Object.assign(this.style,{top:"",left:"",width:"",height:""});this.removeEventListener("ui5-before-close",this._revertSize)}_onDragMouseDown(e){if(!this._movable||!this.draggable||!p._isHeader(e.target)){return}e.preventDefault();const{top:t,left:i}=this.getBoundingClientRect();const{width:s,height:n}=window.getComputedStyle(this);Object.assign(this.style,{top:`${t}px`,left:`${i}px`,width:`${Math.round(Number.parseFloat(s)*100)/100}px`,height:`${Math.round(Number.parseFloat(n)*100)/100}px`});this._x=e.clientX;this._y=e.clientY;this._attachMouseDragHandlers()}_onDragMouseMove(e){e.preventDefault();const t=this._x-e.clientX;const i=this._y-e.clientY;const{left:s,top:n}=this.getBoundingClientRect();Object.assign(this.style,{left:`${Math.floor(s-t)}px`,top:`${Math.floor(n-i)}px`});this._x=e.clientX;this._y=e.clientY}_onDragMouseUp(){this._x=null;this._y=null;this._detachMouseDragHandlers()}_onDragOrResizeKeyDown(e){if(!this._movable||!p._isHeader(e.target)){return}if(this.draggable&&[i.isUp,i.isDown,i.isLeft,i.isRight].some(t=>t(e))){this._dragWithEvent(e);return}if(this.resizable&&[i.isUpShift,i.isDownShift,i.isLeftShift,i.isRightShift].some(t=>t(e))){this._resizeWithEvent(e)}}_dragWithEvent(e){const{top:t,left:s,width:n,height:r}=this.getBoundingClientRect();let h,o;switch(true){case i.isUp(e):h=t-u;o="top";break;case i.isDown(e):h=t+u;o="top";break;case i.isLeft(e):h=s-u;o="left";break;case i.isRight(e):h=s+u;o="left";break}h=c(h,0,o==="left"?window.innerWidth-n:window.innerHeight-r);this.style[o]=`${h}px`}_resizeWithEvent(e){this._detachScreenResizeHandler();this.addEventListener("ui5-before-close",this._revertSize);const{top:t,left:s}=this.getBoundingClientRect(),n=window.getComputedStyle(this),r=Number.parseFloat(n.minWidth),h=window.innerWidth-s,o=window.innerHeight-t;let a=Number.parseFloat(n.width),d=Number.parseFloat(n.height);switch(true){case i.isUpShift(e):d-=u;break;case i.isDownShift(e):d+=u;break;case i.isLeftShift(e):a-=u;break;case i.isRightShift(e):a+=u;break}a=c(a,r,h);d=c(d,this._minHeight,o);Object.assign(this.style,{width:`${a}px`,height:`${d}px`})}_attachMouseDragHandlers(){this._detachScreenResizeHandler();window.addEventListener("mousemove",this._dragMouseMoveHandler);window.addEventListener("mouseup",this._dragMouseUpHandler)}_detachMouseDragHandlers(){window.removeEventListener("mousemove",this._dragMouseMoveHandler);window.removeEventListener("mouseup",this._dragMouseUpHandler)}_onResizeMouseDown(e){if(!this._movable||!this.resizable){return}e.preventDefault();const{top:t,left:i}=this.getBoundingClientRect();const{width:s,height:n,minWidth:r}=window.getComputedStyle(this);this._initialX=e.clientX;this._initialY=e.clientY;this._initialWidth=Number.parseFloat(s);this._initialHeight=Number.parseFloat(n);this._initialTop=t;this._initialLeft=i;this._minWidth=Number.parseFloat(r);this._cachedMinHeight=this._minHeight;Object.assign(this.style,{top:`${t}px`,left:`${i}px`});this._attachMouseResizeHandlers()}_onResizeMouseMove(e){const{clientX:t,clientY:i}=e;let s,n;if(this._isRTL){s=c(this._initialWidth-(t-this._initialX),this._minWidth,this._initialLeft+this._initialWidth);n=c(this._initialLeft+(t-this._initialX),0,this._initialX+this._initialWidth-this._minWidth)}else{s=c(this._initialWidth+(t-this._initialX),this._minWidth,window.innerWidth-this._initialLeft)}const r=c(this._initialHeight+(i-this._initialY),this._cachedMinHeight,window.innerHeight-this._initialTop);Object.assign(this.style,{height:`${r}px`,width:`${s}px`,left:n?`${n}px`:undefined})}_onResizeMouseUp(){delete this._initialX;delete this._initialY;delete this._initialWidth;delete this._initialHeight;delete this._initialTop;delete this._initialLeft;delete this._minWidth;delete this._cachedMinHeight;this._detachMouseResizeHandlers()}_attachMouseResizeHandlers(){this._detachScreenResizeHandler();window.addEventListener("mousemove",this._resizeMouseMoveHandler);window.addEventListener("mouseup",this._resizeMouseUpHandler);this.addEventListener("ui5-before-close",this._revertSize)}_detachMouseResizeHandlers(){window.removeEventListener("mousemove",this._resizeMouseMoveHandler);window.removeEventListener("mouseup",this._resizeMouseUpHandler)}}p.define();return p});